"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[951],{5754:function(e,t,i){i.r(t),i.d(t,{Button:function(){return u},buttonVariants:function(){return s}});var r=i(3827),o=i(4090),n=i(9143),l=i(9769),a=i(1657);let s=(0,l.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),u=o.forwardRef((e,t)=>{let{className:i,variant:o,size:l,asChild:u=!1,...d}=e,c=u?n.g7:"button";return(0,r.jsx)(c,{className:(0,a.cn)(s({variant:o,size:l,className:i})),ref:t,...d})});u.displayName="Button"},2406:function(e,t,i){i.r(t),i.d(t,{AuthProvider:function(){return a},useAuth:function(){return s}});var r=i(3827),o=i(4090),n=i(4175);let l=(0,o.createContext)({user:null,isLoading:!0,logout:()=>{}});function a(e){let{children:t}=e,[i,a]=(0,o.useState)(null),[s,u]=(0,o.useState)(!0);return(0,o.useEffect)(()=>((0,n.Z5)(),(0,n.Aj)(e=>{a(e),u(!1)})),[]),(0,r.jsx)(l.Provider,{value:{user:i,isLoading:s,logout:n.kS},children:t})}function s(){return(0,o.useContext)(l)}},4175:function(e,t,i){i.d(t,{Aj:function(){return d},OQ:function(){return r},Z5:function(){return c},kS:function(){return s},uV:function(){return l},x4:function(){return a}});let r=(0,i(9377).eI)("https://cvjfytrbzfqwxszhcmvq.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN2amZ5dHJiemZxd3hzemhjbXZxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDEwMDc3ODUsImV4cCI6MjA1NjU4Mzc4NX0.tGEazNPRhhCuQ_PZOOm2lNIa7IIXAbOF_ZJLhSjUuaw"),o=null,n=[];async function l(e){let{data:t,error:i}=await r.from("invitation_codes").select("*").eq("code",e).eq("is_active",!0).single();if(i||!t)return!1;let o=new Date;return!(t.expires_at&&new Date(t.expires_at)<o)&&!(t.uses_count>=t.uses_allowed)}async function a(e){let{data:t,error:i}=await r.from("users").select("*").eq("username",e).single();if(!t||i){if(!await l(e))return{user:null,error:"Code d'invitation invalide"};let t={id:"temp_".concat(Date.now()),username:"Invit\xe9",invitationCode:e};return u(t),localStorage.setItem("bluum_invitation_code",e),{user:t,error:null}}await r.from("users").update({last_login:new Date().toISOString()}).eq("id",t.id);let o={id:t.id,email:t.email,username:t.username,fullName:t.full_name,avatarUrl:t.avatar_url};return u(o),localStorage.setItem("bluum_user_id",o.id),{user:o,error:null}}function s(){u(null),localStorage.removeItem("bluum_user_id"),localStorage.removeItem("bluum_invitation_code")}function u(e){o=e,n.forEach(t=>t(e))}function d(e){return n.push(e),e(o),()=>{let t=n.indexOf(e);-1!==t&&n.splice(t,1)}}function c(){{let e=localStorage.getItem("bluum_user_id");if(e)r.from("users").select("*").eq("id",e).single().then(e=>{let{data:t,error:i}=e;!i&&t?u({id:t.id,email:t.email,username:t.username,fullName:t.full_name,avatarUrl:t.avatar_url}):s()});else{let e=localStorage.getItem("bluum_invitation_code");e&&l(e).then(t=>{t?u({id:"temp_".concat(Date.now()),username:"Invit\xe9",invitationCode:e}):localStorage.removeItem("bluum_invitation_code")})}}}},1657:function(e,t,i){i.d(t,{cn:function(){return n},m:function(){return l}});var r=i(3167),o=i(1367);function n(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,o.m6)((0,r.W)(t))}function l(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1080,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1920,n=r/2,l="top"===i.position?.15*o:"middle"===i.position?.5*o:.85*o;l+=i.offset/50*(.1*o),e.textAlign="center",e.textBaseline="middle";let a=Math.floor(.06*r);function s(t,i,r){let o=t.split(" "),n=[],l="";for(let t=0;t<o.length;t++){let a=o[t],s=a.length>12?function(e){let t=[],i="";for(let r=0;r<e.length;r++)(12===(i+=e[r]).length||r===e.length-1)&&(t.push(i),i="");return t}(a):[a];for(let t=0;t<s.length;t++){let o=s[t];if(e.measureText(o+" ").width,""===l)l=o,e.measureText(o).width;else{let t=l+" "+o,a=e.measureText(t).width;if(a<=i){if(2===r.type&&n.length>0&&50>Math.abs(e.measureText(n[n.length-1]).width-a)){n.push(l),l=o;continue}l=t}else n.push(l),l=o}}}return""!==l&&n.push(l),n}if(e.font="".concat(a,'px "TikTok Display Medium", "Apple Color Emoji"'),2===i.type){e.font="600 ".concat(a,'px "TikTok Display Medium", "Apple Color Emoji"');let o=s(t,.85*r,i),u=1.2*a,d=u*o.length;o.forEach((t,i)=>{let r=l-d/2+i*u+u/2;!function(t,i,r,o,n,l){let a=e.measureText(t).width+64,s=u+(0===o||o===n-1?10:0),d=i-a/2,c=r-s/2-(0===o?5:o===n-1?-5:0),f=o>0?e.measureText(l[o-1]).width+64:0,m=o<n-1?e.measureText(l[o+1]).width+64:0;e.save(),e.beginPath(),0===o?(e.moveTo(d+18,c),e.lineTo(d+a-18,c),e.quadraticCurveTo(d+a,c,d+a,c+18),m>a?(e.lineTo(d+a,c+s-18),e.quadraticCurveTo(d+a,c+s,d+a+18,c+s)):(e.lineTo(d+a,c+s-18),e.quadraticCurveTo(d+a,c+s,d+a-18,c+s)),m>a?e.lineTo(d-18,c+s):e.lineTo(d+18,c+s),e.quadraticCurveTo(d,c+s,d,c+s-18),e.lineTo(d,c+18),e.quadraticCurveTo(d,c,d+18,c)):o===n-1?(f>a?e.moveTo(d-18,c):e.moveTo(d+18,c),e.quadraticCurveTo(d,c,d,c+18),e.lineTo(d,c+s-18),e.quadraticCurveTo(d,c+s,d+18,c+s),e.lineTo(d+a-18,c+s),e.quadraticCurveTo(d+a,c+s,d+a,c+s-18),f>a?(e.lineTo(d+a,c+18),e.quadraticCurveTo(d+a,c,d+a+18,c)):(e.lineTo(d+a,c+18),e.quadraticCurveTo(d+a,c,d+a-18,c))):(f>a?e.moveTo(d-18,c):e.moveTo(d+18,c),e.quadraticCurveTo(d,c,d,c+18),e.lineTo(d,c+s-18),m>a?e.quadraticCurveTo(d,c+s,d-18,c+s):e.quadraticCurveTo(d,c+s,d+18,c+s),m>a?e.lineTo(d+a+18,c+s):e.lineTo(d+a-18,c+s),e.quadraticCurveTo(d+a,c+s,d+a,c+s-18),e.lineTo(d+a,c+18),f>a?e.quadraticCurveTo(d+a,c,d+a+18,c):e.quadraticCurveTo(d+a,c,d+a-18,c)),e.closePath(),e.shadowColor="rgba(0, 0, 0, 0.1)",e.shadowBlur=6,e.shadowOffsetX=0,e.shadowOffsetY=1.8,e.fillStyle="#FFFFFF",e.fill(),e.restore()}(t,n,r,i,o.length,o),e.fillStyle="#000000",e.textBaseline="middle",e.fillText(t,n,r)})}else{e.font="".concat(a,'px "TikTok Display Medium", "Apple Color Emoji"'),e.letterSpacing="0.001em",e.textBaseline="middle";let o=s(t,.8*r,i),u=1.2*a,d=u*o.length;o.forEach((t,i)=>{let r=l-d/2+i*u+u/2;e.lineWidth=4,e.strokeStyle="#000000",[[-1,-1],[0,-1],[1,-1],[-1,0],[1,0],[-1,1],[0,1],[1,1]].forEach(i=>{let[o,l]=i;e.strokeText(t,n+2*o,r+2*l)}),e.fillStyle="#FFFFFF",e.fillText(t,n,r)})}}},8227:function(e,t,i){i.d(t,{J:function(){return n},d:function(){return l}});var r=i(2574),o=i(5249);let n=(0,r.U)()((0,o.tJ)((e,t)=>({videos:[],selectedVideos:[],addVideo:(i,r)=>{let o=Date.now(),n="",l=i.includes("/temp-videos/");try{let e=i.split("/");(n=e[e.length-1])&&""!==n||(n="video_".concat(o,".mp4"))}catch(e){n="video_".concat(o,".mp4")}let a=t().videos.find(e=>e.path===i);if(a){e(e=>({videos:e.videos.map(e=>e.id===a.id?{...e,expiresAt:r||o+9e5}:e)}));return}let s={id:Math.random().toString(36).substring(2,15),path:i,fileName:n,createdAt:o,expiresAt:r||o+9e5,isTemporary:l,selected:!1};e(e=>({videos:[...e.videos,s]})),l&&setTimeout(()=>{t().triggerCleanup()},901e3)},removeVideo:t=>{e(e=>({videos:e.videos.filter(e=>e.id!==t),selectedVideos:e.selectedVideos.filter(e=>e!==t)}))},clearExpiredVideos:()=>{let t=Date.now();e(e=>{let i=e.videos.filter(e=>e.expiresAt>t),r=e.selectedVideos.filter(e=>i.some(t=>t.id===e));return{videos:i,selectedVideos:r}})},triggerCleanup:async()=>{try{let e=await fetch("/api/cleanup-temp");return t().clearExpiredVideos(),console.log("Nettoyage des fichiers temporaires d\xe9clench\xe9"),await e.json()}catch(e){console.error("Erreur lors du nettoyage:",e),t().clearExpiredVideos()}},toggleVideoSelection:t=>{e(e=>e.selectedVideos.includes(t)?{selectedVideos:e.selectedVideos.filter(e=>e!==t)}:{selectedVideos:[...e.selectedVideos,t]})},selectAllVideos:()=>{e(e=>({selectedVideos:e.videos.map(e=>e.id)}))},deselectAllVideos:()=>{e({selectedVideos:[]})},removeSelectedVideos:()=>{e(e=>({videos:e.videos.filter(t=>!e.selectedVideos.includes(t.id)),selectedVideos:[]}))},getSelectedVideoPaths:()=>{let{videos:e,selectedVideos:i}=t();return e.filter(e=>i.includes(e.id)).map(e=>({path:e.path,fileName:e.fileName}))}}),{name:"bluum-user-videos",partialize:e=>({videos:e.videos,selectedVideos:e.selectedVideos})})),l=()=>{n.getState().clearExpiredVideos(),n.getState().triggerCleanup();let e=setInterval(()=>{n.getState().clearExpiredVideos(),n.getState().triggerCleanup()},3e5);return()=>clearInterval(e)}}}]);