(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[572],{2565:function(e,t,r){Promise.resolve().then(r.bind(r,5316))},5316:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return I}});var a=r(3827),o=r(4090),l=r(5754),s=r(1657);let i=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,a.jsx)("textarea",{className:(0,s.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...o})});i.displayName="Textarea";var n=r(7531);let c=o.forwardRef((e,t)=>{let{className:r,children:o,...l}=e;return(0,a.jsxs)(n.fC,{ref:t,className:(0,s.cn)("relative overflow-hidden",r),...l,children:[(0,a.jsx)(n.l_,{className:"h-full w-full rounded-[inherit]",children:o}),(0,a.jsx)(d,{}),(0,a.jsx)(n.Ns,{})]})});c.displayName=n.fC.displayName;let d=o.forwardRef((e,t)=>{let{className:r,orientation:o="vertical",...l}=e;return(0,a.jsx)(n.gb,{ref:t,orientation:o,className:(0,s.cn)("flex touch-none select-none transition-colors","vertical"===o&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===o&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...l,children:(0,a.jsx)(n.q4,{className:"relative flex-1 rounded-full bg-border"})})});d.displayName=n.gb.displayName;var m=r(62),u=r(4732),h=r(6210),f=r(3081),g=r(8728),x=r(5922),p=r(9129),v=r(2406);let w=null;Promise.all([r.e(781),r.e(500)]).then(r.bind(r,6173)).then(e=>{w=e}).catch(e=>{console.warn("Erreur lors du chargement du module ffmpeg:",e)});var b=r(9577),y=r.n(b),j=r(3220);r(8062);var k=r(8227),N=r(8312),E=r(7907);function S(e){return e?"".concat(Math.floor(e/60),":").concat(Math.floor(e%60).toString().padStart(2,"0")):"0:00"}function _(e){let{template:t,alt:r,position:l="center"}=e;console.log("TemplateImage rendering with template:",t,"alt:",r,"position:",l);let[s,i]=(0,o.useState)(!1),[n,c]=(0,o.useState)(!1),[d,m]=(0,o.useState)(!0),u=(0,o.useMemo)(()=>{if(!(null==t?void 0:t.url))return console.log("No template URL provided"),"";if(t.url.startsWith("local_storage_"))try{let e=localStorage.getItem(t.url);if(e)return console.log("Retrieved from localStorage:",t.url),e}catch(e){console.error("Error accessing localStorage:",e)}return t.url},[null==t?void 0:t.url]);return(console.log("Display URL after processing:",u),(0,o.useEffect)(()=>{if(m(!0),i(!1),console.log("Template type check:",null==t?void 0:t.type),(null==t?void 0:t.type)==="video"){console.log("Template type is explicitly set to video"),c(!0),m(!1);return}if(u){let e=u.match(/\.(mp4|webm|ogg|mov|avi|wmv)($|\?)/i)||u.includes("video/mp4")||u.includes("video/webm")||u.includes("video/ogg")||u.includes("video/quicktime")||u.includes("video/avi"),t=u.startsWith("blob:")||u.startsWith("data:video"),r=e||t;console.log("URL video detection:",r?"Is video":"Is image","URL:",u,"Matches:",{isVideoUrl:e,isBlobOrDataVideo:t}),c(r),m(!1)}},[u,t]),!u||s)?(console.log("No display URL available or media error, showing placeholder"),(0,a.jsxs)("div",{className:"w-full h-full bg-gray-200 flex flex-col items-center justify-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"No media"}),s&&(0,a.jsx)("span",{className:"text-xs text-red-400 mt-1",children:"Error loading media"})]})):d?(0,a.jsx)("div",{className:"w-full h-full bg-gray-100 flex flex-col items-center justify-center",children:(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"Loading..."})}):(0,a.jsx)("div",{className:"relative w-full h-full overflow-hidden",children:n?(0,a.jsx)("video",{src:u,className:"absolute inset-0 w-full h-full object-cover ".concat("top"===l?"object-top":"bottom"===l?"object-bottom":"object-center"),muted:!0,loop:!0,playsInline:!0,autoPlay:!0,controls:!1,onLoadStart:()=>console.log("Video load started for:",u),onLoadedMetadata:()=>console.log("Video metadata loaded for:",u),onLoadedData:()=>console.log("Video data loaded successfully for:",u),onCanPlay:()=>console.log("Video can play now for:",u),onPlay:()=>console.log("Video started playing for:",u),onError:e=>{let t=e.currentTarget;console.error("Error loading video:",{mediaError:t.error?{code:t.error.code,message:t.error.message,MEDIA_ERR_DECODE:t.error.MEDIA_ERR_DECODE,MEDIA_ERR_NETWORK:t.error.MEDIA_ERR_NETWORK,MEDIA_ERR_SRC_NOT_SUPPORTED:t.error.MEDIA_ERR_SRC_NOT_SUPPORTED,MEDIA_ERR_ABORTED:t.error.MEDIA_ERR_ABORTED}:"No specific error details",src:u,videoElementInfo:{networkState:t.networkState,readyState:t.readyState}}),i(!0),t.classList.add("video-error")}},"video-".concat(u)):(0,a.jsx)(y(),{src:u,alt:r,layout:"fill",className:"absolute inset-0 w-full h-full object-cover ".concat("top"===l?"object-top":"bottom"===l?"object-bottom":"object-center"),onLoad:()=>console.log("Image loaded successfully"),onError:e=>{console.error("Error loading image:",{src:u,target:e.currentTarget?"HTMLImageElement":"unknown",error:"Failed to load image"}),i(!0),e.currentTarget&&(e.currentTarget.classList.add("image-error"),e.currentTarget.setAttribute("title","Failed to load: ".concat(u)))}},"img-".concat(u))})}let C=e=>{localStorage.setItem("bluum-generation-state",JSON.stringify(e))},M=()=>{let e=localStorage.getItem("bluum-generation-state");return e?JSON.parse(e):null},T=()=>{localStorage.removeItem("bluum-generation-state")},L={INIT:5,TEMPLATE_PREP:5,MEDIA_PREP:5,VIDEO_START:5,COMPLETION:100},A=(e,t)=>10+(e+t)/1048576*.5;function I(){var e,t,r,n;let{user:d}=(0,g.aF)(),{mediaFiles:b}=(0,p.B)(),[I,R]=(0,o.useState)(null),[D,P]=(0,o.useState)([]),[O,F]=(0,o.useState)(null),[U,W]=(0,o.useState)([]),[z,V]=(0,o.useState)(""),[B,G]=(0,o.useState)(new Set([2])),[H,q]=(0,o.useState)(2),[Q,Z]=(0,o.useState)(1),[J,Y]=(0,o.useState)(!0),[K,X]=(0,o.useState)(null),$=(0,o.useRef)(null),[ee,et]=(0,o.useState)({min:4,max:6}),[er,ea]=(0,o.useState)({min:4,max:6}),[eo,el]=(0,o.useState)([]),[es,ei]=(0,o.useState)(new Set),[en,ec]=(0,o.useState)("top"),[ed,em]=(0,o.useState)(0),[eu,eh]=(0,o.useState)({position:"top",offset:0}),[ef,eg]=(0,o.useState)({position:"top",offset:0}),[ex,ep]=(0,o.useState)("center"),[ev,ew]=(0,o.useState)(!1),[eb,ey]=(0,o.useState)(!1),[ej,ek]=(0,o.useState)(0),[eN,eE]=(0,o.useState)(0),[eS,e_]=(0,o.useState)([]),[eC,eM]=(0,o.useState)(!1),[eT,eL]=(0,o.useState)(null),[eA,eI]=(0,o.useState)(0),eR=(0,o.useRef)(null),{uploadTemplate:eD}=function(){let{user:e}=(0,v.useAuth)(),[t,r]=(0,o.useState)(!1),[a,l]=(0,o.useState)(null),s=(0,o.useCallback)(async e=>{if(e.id)try{await x.OQ.from("users").upsert({id:e.id,email:e.email||"",username:e.username||"",full_name:e.fullName||"",avatar_url:e.avatarUrl||"",updated_at:new Date().toISOString()})}catch(e){console.error("Error syncing user data:",e)}},[]),i=(0,o.useCallback)(async t=>{if(!e)throw Error("User not authenticated");r(!0),l(null);try{let{data:r,error:a}=await x.OQ.from("users").upsert({id:e.id,email:e.email||""}).select().single();if(a)throw a;let{data:o,error:l}=await x.OQ.from("projects").insert({user_id:r.id,name:t}).select().single();if(l)throw l;return o}catch(e){throw l(e instanceof Error?e.message:"An error occurred"),e}finally{r(!1)}},[e]),n=(0,o.useCallback)(async(t,a,o,s)=>{if(!e)throw Error("User not authenticated");r(!0),l(null);try{let r;let l="".concat(e.id,"/").concat(a,"/templates/").concat(Date.now(),"-").concat(t.name),i=await (0,x.tL)(t,"templates",l);if("supabase"===i.storage){let{data:e,error:t}=await x.OQ.from("templates").insert({project_id:a,storage_path:l,position_x:o.x,position_y:o.y,scale:o.scale,duration:s}).select().single();t?console.warn("Failed to insert template record in database:",t):r=e}if(r)r.storage_type=i.storage;else{let e=new Date().toISOString();r={id:"local_".concat(Date.now()),project_id:a,storage_path:i.path,position_x:o.x,position_y:o.y,scale:o.scale,duration:s,created_at:e,storage_type:i.storage};try{let e=JSON.parse(localStorage.getItem("local_templates")||"[]");e.push(r),localStorage.setItem("local_templates",JSON.stringify(e))}catch(e){console.warn("Failed to store template metadata in localStorage:",e)}}return r}catch(e){throw l(e instanceof Error?e.message:"An error occurred"),e}finally{r(!1)}},[e]),c=(0,o.useCallback)(async(t,a,o,s,i)=>{if(!e)throw Error("User not authenticated");r(!0),l(null);try{let r="".concat(e.id,"/").concat(a,"/media/").concat(Date.now(),"-").concat(t.name);await (0,x.cT)(t,"media",r);let{data:l,error:n}=await x.OQ.from("media").insert({project_id:a,storage_path:r,type:o,duration:s,order_index:i}).select().single();if(n)throw n;return l}catch(e){throw l(e instanceof Error?e.message:"An error occurred"),e}finally{r(!1)}},[e]),d=(0,o.useCallback)(async(t,a,o)=>{if(!e)throw Error("User not authenticated");r(!0),l(null);try{let r="".concat(e.id,"/").concat(a,"/music/").concat(Date.now(),"-").concat(t.name);await (0,x.cT)(t,"music",r);let{data:l,error:s}=await x.OQ.from("music").insert({project_id:a,storage_path:r,order_index:o}).select().single();if(s)throw s;return l}catch(e){throw l(e instanceof Error?e.message:"An error occurred"),e}finally{r(!1)}},[e]);return{syncUser:s,createProject:i,uploadTemplate:n,uploadMedia:c,uploadMusic:d,addHook:(0,o.useCallback)(async(t,a,o)=>{if(!e)throw Error("User not authenticated");r(!0),l(null);try{let{data:e,error:r}=await x.OQ.from("hooks").insert({project_id:t,text:a,position_x:o.x,position_y:o.y}).select().single();if(r)throw r;return e}catch(e){throw l(e instanceof Error?e.message:"An error occurred"),e}finally{r(!1)}},[e]),generateImages:(0,o.useCallback)(async(t,a,o,s)=>{if(!e)throw Error("User not authenticated");r(!0),l(null);try{let{data:r,error:l}=await x.OQ.from("templates").select("*").eq("id",a).single();if(l)throw l;let{data:i,error:n}=await x.OQ.from("hooks").select("*").eq("id",o).single();if(n)throw n;let c=await (0,x.qm)("templates",r.storage_path),d=await w.generateImageWithHook(c,i.text,{type:"withBackground"===s?2:1,position:"middle",offset:0}),m="".concat(Date.now(),"-image.png"),u=new File([d],m,{type:"image/png"}),h="".concat(e.id,"/").concat(t,"/generated/").concat(m);await (0,x.cT)(u,"generated",h);let{data:f,error:g}=await x.OQ.from("generated_images").insert({project_id:t,template_id:a,hook_id:o,storage_path:h,font_type:s}).select().single();if(g)throw g;return f}catch(e){throw l(e instanceof Error?e.message:"An error occurred"),e}finally{r(!1)}},[e]),generateVideo:(0,o.useCallback)(async(t,a,o,s)=>{if(!e)throw Error("User not authenticated");r(!0),l(null);try{let{data:r,error:l}=await x.OQ.from("generated_images").select("\n          *,\n          template:templates(*),\n          hook:hooks(*)\n        ").eq("id",a).single();if(l)throw l;let{data:i,error:n}=await x.OQ.from("media").select("*").eq("id",o).single();if(n)throw n;let{data:c,error:d}=s?await x.OQ.from("music").select("*").eq("id",s).single():{data:null,error:null};if(d)throw d;let m=await (0,x.qm)("generated",r.storage_path),u=await (0,x.qm)("media",i.storage_path),h=c?await (0,x.qm)("music",c.storage_path):null,f=await w.generateVideoWithFFmpeg({templateImage:m,mediaFile:u,hookText:r.hook.text,hookStyle:{type:"withBackgroundBlack"===r.font_type?3:"withBackground"===r.font_type?2:1,position:"middle",offset:0},musicFile:h||void 0}),g="".concat(Date.now(),"-video.mp4"),p=new File([f],g,{type:"video/mp4"}),v="".concat(e.id,"/").concat(t,"/generated/").concat(g);await (0,x.cT)(p,"generated",v);let{data:b,error:y}=await x.OQ.from("generated_videos").insert({project_id:t,generated_image_id:a,media_id:o,music_id:s,storage_path:v}).select().single();if(y)throw y;return b}catch(e){throw l(e instanceof Error?e.message:"An error occurred"),e}finally{r(!1)}},[e]),isLoading:t,error:a}}(),[eP,eO]=(0,o.useState)(0),[eF,eU]=(0,o.useState)(0),[eW,ez]=(0,o.useState)(null),[eV,eB]=(0,o.useState)(!1),{addVideo:eG}=(0,k.J)(),[eH,eq]=(0,o.useState)(!1),[eQ,eZ]=(0,o.useState)(!1),eJ=(0,o.useMemo)(()=>b.filter(e=>"image"===e.type||"video"===e.type),[b]);(0,o.useEffect)(()=>{eW&&!I&&R(null)},[eW,I]),(0,o.useEffect)(()=>{(async()=>{try{let e=new FontFace("TikTok Display Medium","url(/fonts/TikTokDisplayMedium.otf)",{weight:"400",style:"normal"});await e.load(),document.fonts.add(e),document.fonts.check('1em "TikTok Display Medium"')?console.log("TikTok Display Medium font loaded successfully"):console.warn("TikTok Display Medium font not loaded correctly"),document.body.style.setProperty("--font-tiktok",'"TikTok Display Medium", sans-serif'),setTimeout(()=>{ey(!0)},200)}catch(e){console.error("Error loading fonts:",e),ey(!0)}})()},[]);let eY=()=>z.split("\n")[0]||"";(0,o.useEffect)(()=>{if(eb&&eR.current){let e=eR.current,t=e.getContext("2d");if(!t)return;e.width=1080,e.height=1920,t.clearRect(0,0,e.width,e.height);let r=eY();""!==r.trim()&&(t.font="".concat(Math.floor(.07*e.width),'px "TikTok Display Medium", sans-serif'),(0,s.m)(t,r,{type:H,position:1===H?eu.position:ef.position,offset:1===H?eu.offset:ef.offset}))}},[eb,H,eu,ef,z,I]),(0,o.useEffect)(()=>{if(!eR.current||!eb||!z)return;let e=eR.current,t=e.getContext("2d");t&&(t.clearRect(0,0,e.width,e.height),document.fonts.ready.then(()=>{let r=eY();""!==r.trim()&&(t.font="".concat(Math.floor(.07*e.width),'px "TikTok Display Medium", sans-serif'),(0,s.m)(t,r,{type:H,position:1===H?eu.position:ef.position,offset:1===H?eu.offset:ef.offset}))}))},[z,H,eu,ef,eb,I]),(0,o.useEffect)(()=>{(async()=>{if(d)try{Y(!0);let e=p.B.getState().cachedSongs;if(e.length>0){W(e),Y(!1);return}let t=await (0,x.Bi)(d.id);W(t),p.B.getState().setCachedSongs(t)}catch(e){console.error("Error loading songs:",e)}finally{Y(!1)}})()},[d]);let{getRootProps:eK,getInputProps:eX}=(0,m.uI)({accept:{"video/*":[".mp4",".mov",".avi"],"image/*":[".jpg",".jpeg",".png",".gif"]},maxFiles:50,onDrop:e=>{(async()=>{let t=[];for(let r of e){let e=URL.createObjectURL(r);if(r.type.startsWith("video/")){let a=document.createElement("video");a.src=e;let o=await new Promise(e=>{a.onloadedmetadata=()=>{e({duration:a.duration,width:a.videoWidth,height:a.videoHeight})},setTimeout(()=>e({duration:5,width:1080,height:1920}),1e3)}),l=o.width/o.height,s=.05>Math.abs(l-.5625);t.push({file:r,type:"video",duration:o.duration,url:e,aspectRatio:l,isCorrectRatio:s})}else if(r.type.startsWith("image/")){let a=await new Promise(t=>{let r=document.createElement("img");r.onload=()=>{t({width:r.width,height:r.height})},r.src=e}),o=a.width/a.height,l=.05>Math.abs(o-.5625);t.push({file:r,type:"image",duration:5,url:e,aspectRatio:o,isCorrectRatio:l})}}el(e=>[...e,...t].slice(0,50)),setTimeout(()=>{t.forEach((e,t)=>{if("video"===e.type){let e=t+eo.length,r=document.getElementById("video-".concat(e));r&&r.play().catch(e=>{console.log("Auto-play prevented:",e)})}})},500)})()}}),e$=eJ.length>0?[eJ[eJ.length-1]]:[],e0=e=>{if(K===e.id){var t;null===(t=$.current)||void 0===t||t.pause(),X(null)}else{$.current&&$.current.pause();let t=new Audio(e.url);$.current=t,t.onended=()=>{X(null)},t.play(),X(e.id)}};(0,o.useEffect)(()=>()=>{$.current&&($.current.pause(),$.current=null)},[]);let e1=e=>{let t=new Set(es);t.has(e)?t.delete(e):t.add(e),ei(t)},e2=(e,t)=>{t.stopPropagation(),ep(e)};(0,o.useEffect)(()=>{let e=null,t=0,r=null,a=()=>{e&&(e.close(),e=null),r&&(clearTimeout(r),r=null)},o=()=>{a();try{console.log("Connecting to SSE..."),(e=new EventSource("/api/progress",{withCredentials:!1})).onopen=()=>{console.log("SSE connection opened successfully"),t=0},e.onmessage=e=>{try{let t=JSON.parse(e.data);"number"==typeof t.progress&&eI(t.progress)}catch(e){console.error("Error parsing SSE data:",e)}},e.onerror=e=>{if(console.error("EventSource error:",e),a(),t<5){let e=Math.min(1e3*Math.pow(2,t)+1e3*Math.random(),1e4);t++,console.log("Attempting to reconnect in ".concat(Math.round(e/1e3)," seconds... (Attempt ").concat(t,"/").concat(5,")")),r=setTimeout(o,e)}else console.error("Max retry attempts reached. Please refresh the page to reconnect.")}}catch(e){console.error("Error creating EventSource:",e),t<5&&(r=setTimeout(o,1e3))}};return o(),()=>{console.log("Cleaning up SSE connection"),a()}},[]);let e5=e=>new Promise((t,r)=>{let a=new FileReader;a.onloadend=()=>{"string"==typeof a.result?t(a.result):r(Error("Failed to convert blob to base64"))},a.onerror=r,a.readAsDataURL(e)}),e4=async e=>(await fetch(e)).blob();(0,o.useEffect)(()=>{let e=M();e&&e.isGenerating&&(ew(e.isGenerating),eI(e.progress),e_(e.generatedVideos),ek(e.generatedCount),eE(e.totalToGenerate),eO(e.currentHookIndex),eU(e.currentMediaIndex),e.isGenerating&&e.generatedCount<e.totalToGenerate&&(window.confirm("La g\xe9n\xe9ration de vid\xe9os a \xe9t\xe9 interrompue (".concat(e.generatedCount,"/").concat(e.totalToGenerate," termin\xe9es). Voulez-vous reprendre la g\xe9n\xe9ration?"))?setTimeout(()=>{e3()},1e3):(T(),ew(!1))))},[]);let e3=async()=>{try{let e=M();if(!e){j.Am.error("\xc9tat de g\xe9n\xe9ration perdu. Veuillez recommencer."),ew(!1);return}if(!I||0===eo.length||!O||!z){j.Am.error("Impossible de reprendre la g\xe9n\xe9ration. Certains \xe9l\xe9ments sont manquants."),ew(!1),T();return}let t=eJ.find(e=>e.id===I);if(!t){j.Am.error("Template non trouv\xe9."),ew(!1),T();return}t.url,t.type;let r=z.split("\n").map(e=>e.trim()).filter(e=>e&&"Enter your hook here or load from a text file.."!==e);if(0===r.length){j.Am.error("Veuillez entrer au moins un hook valide."),ew(!1),T();return}let a=Array.from(es).map(e=>eo[e]);O.id,O.url;let o=e.generatedCount;j.Am.success("Reprise de la g\xe9n\xe9ration \xe0 partir de la vid\xe9o ".concat(o+1,"/").concat(e.totalToGenerate));for(let t=e.currentHookIndex;t<r.length;t++){eO(t);let r=t===e.currentHookIndex?e.currentMediaIndex:0;for(let l=r;l<a.length;l++)eU(l),C({isGenerating:!0,progress:Math.round(o/e.totalToGenerate*100),generatedVideos:eS,generatedCount:o,totalToGenerate:e.totalToGenerate,currentHookIndex:t,currentMediaIndex:l}),o++,ek(o),eI(Math.round(o/e.totalToGenerate*100))}T(),eI(100),eq(!0),setTimeout(()=>{eq(!1),eZ(!0)},2e3)}catch(e){console.error("Erreur lors de la reprise de la g\xe9n\xe9ration:",e),j.Am.error("Une erreur est survenue lors de la reprise de la g\xe9n\xe9ration")}finally{ew(!1)}},e6=async()=>{try{if(ew(!0),eI(L.INIT),e_([]),eO(0),eU(0),!I){j.Am.error("Veuillez s\xe9lectionner un template pour la partie 1."),ew(!1);return}if(0===eo.length){j.Am.error("Veuillez s\xe9lectionner au moins un m\xe9dia pour la partie 2."),ew(!1);return}if(!O){j.Am.error("Veuillez s\xe9lectionner une musique."),ew(!1);return}if(!z||""===z.trim()||"Enter your hook here or load from a text file.."===z){j.Am.error("Veuillez entrer au moins un hook."),ew(!1);return}let e=eJ.find(e=>e.id===I);if(!e){j.Am.error("Template non trouv\xe9."),ew(!1);return}eI(L.TEMPLATE_PREP);let t=e.url,r=e.type||"image";try{if(t.startsWith("blob:")||t.startsWith("local_storage_")){if(t.startsWith("local_storage_")){let e=localStorage.getItem(t);if(e)t=e;else throw Error("Template non trouv\xe9 dans le localStorage")}else{let e=await e4(t);t=await e5(e)}r=t.includes("video/")?"video":"image"}}catch(e){console.error("Erreur lors de la conversion du template:",e),j.Am.error("Erreur lors de la pr\xe9paration du template"),ew(!1);return}let a={url:t,type:r},o=z.split("\n").map(e=>e.trim()).filter(e=>e&&"Enter your hook here or load from a text file.."!==e);if(0===o.length){j.Am.error("Veuillez entrer au moins un hook valide."),ew(!1);return}eI(L.MEDIA_PREP);let l=Array.from(es).map(e=>eo[e]),s=await Promise.all(l.map(async e=>{if(!e.url)return e;try{let t=e.url;if(t.startsWith("blob:")||t.startsWith("local_storage_")){if(t.startsWith("local_storage_")){let e=localStorage.getItem(t);if(e)t=e;else throw Error("M\xe9dia non trouv\xe9 dans le localStorage")}else{let e=await e4(t);t=await e5(e)}}return{...e,url:t,type:t.includes("video/")?"video":"image"}}catch(e){throw console.error("Erreur lors de la conversion du m\xe9dia:",e),Error("Erreur lors de la pr\xe9paration du m\xe9dia")}})),i=o.length;eE(i);let n={id:O.id,url:O.url};eI(L.VIDEO_START),C({isGenerating:!0,progress:L.VIDEO_START,generatedVideos:[],generatedCount:0,totalToGenerate:i,currentHookIndex:0,currentMediaIndex:0});let c=0;for(let e=0;e<i;e++){let t;eO(e);let r=e%s.length;eU(r);let l=o[e],d=s[r],m="image"===d.type,u="image"===a.type,h=90/i;eI(Math.round(5+e/i*90)),C({isGenerating:!0,progress:Math.round(5+e/i*90),generatedVideos:eS,generatedCount:c,totalToGenerate:i,currentHookIndex:e,currentMediaIndex:r});let f=(ee.min+ee.max)/2,g=(er.min+er.max)/2,x=f+g;t=m&&u?15e3:m||u?3e4:45e3;let p=x/10,v=Math.round(t*p);console.log("G\xe9n\xe9ration vid\xe9o ".concat(e+1,"/").concat(i,":"),{isImage:m,isFixedPartImage:u,part1AvgDuration:f,part2AvgDuration:g,totalDuration:x,baseEstimatedTime:t,durationFactor:p,estimatedTime:v});let w=Date.now(),b=setInterval(()=>{let t=Date.now()-w,a=Math.min(t/v,.95),o=Math.round(5+e/i*90+h*a),l=Math.min(o,95);eI(l),C({isGenerating:!0,progress:l,generatedVideos:eS,generatedCount:c,totalToGenerate:i,currentHookIndex:e,currentMediaIndex:r})},500),y={hook:{text:l,style:H,position:1===H?eu.position:ef.position,offset:1===H?eu.offset:ef.offset},part1:{url:a.url,type:a.type,position:ex,duration:{min:ee.min,max:ee.max}},part2:{url:d.url,type:d.type},part2Duration:{min:er.min,max:er.max},song:n};try{let e=await fetch("/api/create-video",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)});if(e.ok){let t=await e.json(),r=t.videoPath,a=t.expiresAt;eG(r,a),e_(e=>[...e,r])}else{let t=await e.text();console.error("Erreur response du serveur:",t),j.Am.error("Erreur de cr\xe9ation de vid\xe9o: ".concat(t))}}catch(e){console.error("Erreur lors de la cr\xe9ation de la vid\xe9o:",e),j.Am.error("Erreur lors de la cr\xe9ation de la vid\xe9o")}clearInterval(b),c++,ek(c);let k=Math.min(Math.round(5+(e+1)/i*90),95);eI(k),C({isGenerating:!0,progress:k,generatedVideos:eS,generatedCount:c,totalToGenerate:i,currentHookIndex:e,currentMediaIndex:r})}eI(L.COMPLETION),eq(!0),setTimeout(()=>{eq(!1),eZ(!0)},2e3)}catch(e){console.error("Erreur lors de la g\xe9n\xe9ration des vid\xe9os:",e),j.Am.error("Une erreur est survenue lors de la g\xe9n\xe9ration des vid\xe9os")}finally{ew(!1)}};(0,o.useEffect)(()=>{let e=()=>{"hidden"===document.visibilityState&&ev&&C({isGenerating:ev,progress:eA,generatedVideos:eS,generatedCount:ej,totalToGenerate:eN,currentHookIndex:eP,currentMediaIndex:eF})};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[ev,eA,eS,ej,eN,eP,eF]),(0,o.useEffect)(()=>{ev||T()},[ev]);let e8=e=>{let t=document.createElement("a");e.startsWith("/temp-videos/")?t.href=e:e.includes("supabase")||e.startsWith("http")?t.href=e:t.href=e.startsWith("/generated/")?e:"/generated/".concat(e);let r=e.split("/").pop();r&&""!==r.trim()||(r="video_".concat(Date.now(),".mp4")),t.download=r,document.body.appendChild(t),t.click(),document.body.removeChild(t),setTimeout(()=>{let e=new XMLHttpRequest;e.open("HEAD",t.href,!0),e.onreadystatechange=function(){4===e.readyState&&200!==e.status&&(j.Am.error("Erreur: Le fichier n'est pas disponible. Veuillez r\xe9essayer plus tard."),console.error("Fichier non disponible: ".concat(t.href)))},e.send()},500)},e7=async()=>{try{if(0===eS.length){j.Am.error("Aucune vid\xe9o \xe0 t\xe9l\xe9charger");return}j.Am.loading("Pr\xe9paration de votre t\xe9l\xe9chargement...");let e=eS.map(e=>{let t=e.split("/").pop()||"video_".concat(Date.now(),".mp4");return{path:e.startsWith("/temp-videos/")?e:e.includes("supabase")||e.startsWith("http")?e:e.startsWith("/generated/")?e:"/generated/".concat(e),fileName:t}});await (0,N.V)(e,"bluum_videos_".concat(Date.now(),".zip")),j.Am.dismiss(),j.Am.success("".concat(e.length," vid\xe9os t\xe9l\xe9charg\xe9es avec succ\xe8s"))}catch(e){console.error("Erreur lors du t\xe9l\xe9chargement des vid\xe9os:",e),j.Am.dismiss(),j.Am.error("Une erreur est survenue lors du t\xe9l\xe9chargement. Veuillez r\xe9essayer.")}},e9=async e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!r)return;if(!d){alert("Please log in to upload templates");return}let a=p.B.getState().mediaFiles||[];a.filter(e=>("image"===e.type||"video"===e.type)&&e.id!==(null==eW?void 0:eW.id));try{eB(!0);let e="default",t=r.type.startsWith("image/"),o=r.type.startsWith("video/");if(!t&&!o){alert("Please upload an image or video file");return}if(r.size>10485760){alert("File size must be less than 10MB for both images and videos");return}r.size>5242880&&console.warn("File size (".concat((r.size/1048576).toFixed(2),"MB) may be too large for localStorage. Using object URL as fallback."));let l=URL.createObjectURL(r),s="",i=.5625,n=5;if(t){let e=await new Promise((e,t)=>{let r=document.createElement("img");r.onload=()=>{e({width:r.width,height:r.height})},r.onerror=()=>t(Error("Failed to load image")),r.src=l});i=e.width/e.height,console.log("Image dimensions: ".concat(e.width,"x").concat(e.height,", ratio: ").concat(i.toFixed(2)))}if(o){let e=await new Promise((e,t)=>{let r=document.createElement("video");r.onloadedmetadata=()=>{e({duration:r.duration,aspectRatio:r.videoWidth/r.videoHeight})},r.onerror=()=>t(Error("Failed to load video")),r.src=l});n=e.duration,i=e.aspectRatio,console.log("Video dimensions: ratio: ".concat(i.toFixed(2),", duration: ").concat(n.toFixed(2),"s"))}console.log("Uploading template...");try{let i=Date.now(),c="user_".concat(d.id,"_").concat(e,"_templates_").concat(i,"_").concat(r.name.replace(/[^a-zA-Z0-9.]/g,"_"));"".concat(e,"/templates/").concat(c);try{if(await (0,x.KG)().catch(e=>{console.warn("Failed to initialize storage buckets:",e)}),o){console.log("Video file detected, using object URL directly"),s=l;try{let e=JSON.parse(localStorage.getItem("object_urls")||"[]");e.push({id:"local_".concat(i),url:l,timestamp:Date.now()}),e.length>5&&e.splice(0,e.length-5),localStorage.setItem("object_urls",JSON.stringify(e))}catch(e){console.warn("Failed to track object URL:",e)}}else if(r.size>2097152)console.log("Large image file detected, using object URL directly"),s=l;else{console.log("Using localStorage for small image file...");let t="local_storage_templates_user_".concat(d.id,"_").concat(e,"_templates_").concat(i,"_").concat(r.name.replace(/[^a-zA-Z0-9.]/g,"_"));try{let e=[];for(let t=0;t<localStorage.length;t++){let r=localStorage.key(t);r&&r.startsWith("local_storage_templates_user_")&&e.push(r)}e.forEach(e=>{localStorage.removeItem(e),console.log("Removed old template from localStorage:",e)})}catch(e){console.warn("Failed to clean localStorage:",e)}try{let e=await new Promise((e,t)=>{let a=new FileReader;a.onload=()=>e(a.result),a.onerror=()=>t(Error("Failed to read file")),a.readAsDataURL(r)});try{localStorage.setItem(t,e),s=t,console.log("Template stored in localStorage with key:",t)}catch(e){console.error("Failed to store in localStorage:",e),s=l,console.log("localStorage error, using object URL instead")}}catch(e){console.error("Failed to read file:",e),s=l,console.log("File reading error, using object URL instead")}}}catch(e){console.error("All storage methods failed:",e),s=l,console.log("Using preview URL as last resort")}let m={id:"local_".concat(i),type:t?"image":"video",url:s,duration:n};console.log("Created new template:",m);let u=[...a.filter(e=>e.id===(null==eW?void 0:eW.id)),m];p.B.setState({mediaFiles:u}),R(m.id)}catch(e){throw console.error("Error in template upload process:",e),e instanceof Error?e:Error("Unknown error during upload")}finally{s!==l&&URL.revokeObjectURL(l)}}catch(e){console.error("Template upload error:",e),alert("Error uploading template: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{eB(!1),e.target.value=""}};(0,o.useEffect)(()=>{(0,x.KG)().catch(e=>{console.error("Failed to initialize storage buckets:",e)})},[]);let te=e=>{el(t=>t.filter((t,r)=>r!==e)),ei(t=>{let r=new Set(t);r.delete(e);let a=new Set;return r.forEach(t=>{t>e?a.add(t-1):a.add(t)}),a})},tt=()=>{p.B.setState({mediaFiles:b.filter(e=>e.id===(null==eW?void 0:eW.id))}),R((null==eW?void 0:eW.id)||null)};(0,o.useEffect)(()=>{if(I){var e;console.log("Preview template:",{selectedId:I,isDefaultTemplate:I===(null==eW?void 0:eW.id),defaultTemplateType:null==eW?void 0:eW.type,foundTemplate:eJ.find(e=>e.id===I),foundTemplateType:null===(e=eJ.find(e=>e.id===I))||void 0===e?void 0:e.type})}},[I,eW,eJ]),(0,o.useEffect)(()=>{let e=document.createElement("style");return e.innerHTML="\n      @keyframes progress {\n        0% { width: 0%; }\n        100% { width: 100%; }\n      }\n      \n      @keyframes fadeInScale {\n        0% { opacity: 0; transform: scale(0.8); }\n        50% { opacity: 1; transform: scale(1.05); }\n        100% { opacity: 1; transform: scale(1); }\n      }\n      \n      @keyframes bounce {\n        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }\n        40% { transform: translateY(-20px); }\n        60% { transform: translateY(-10px); }\n      }\n    ",document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]),(0,o.useEffect)(()=>{{let e=M();e&&e.isGenerating&&(ew(!0),eI(e.progress),e_(e.generatedVideos||[]),ek(e.generatedCount||0),eE(e.totalToGenerate||0),eO(e.currentHookIndex||0),eU(e.currentMediaIndex||0))}},[!0]);let tr=(0,E.useRouter)();return(0,a.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,a.jsx)(j.Ix,{position:"top-right",autoClose:5e3}),(0,a.jsx)("div",{className:"p-4 xl:p-6",suppressHydrationWarning:!0,children:(0,a.jsx)("div",{className:"pt-8 xl:pt-8",suppressHydrationWarning:!0,children:(0,a.jsxs)("div",{className:"flex flex-col space-y-6 mb-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold dark:text-white",children:"Create Your Videos"}),eS.length>0&&!eQ&&!ev&&(0,a.jsxs)("button",{onClick:()=>eZ(!0),className:"fixed bottom-8 right-8 bg-gradient-to-r from-[#f8d4eb] via-[#ce7acb] to-[#e9bcba] text-[#0a0a0c] font-medium px-4 py-3 rounded-xl text-sm flex items-center gap-2 shadow-lg z-40",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download ",eS.length," Videos"]}),(0,a.jsxs)("button",{onClick:()=>tr.push("/pricing"),className:"fixed bottom-16 left-8 bg-gradient-to-r from-[#f8d4eb] via-[#ce7acb] to-[#e9bcba] text-[#0a0a0c] font-medium px-4 py-3 rounded-xl text-sm flex items-center gap-2 shadow-lg z-40",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),"Upgrade"]})]}),(0,a.jsxs)("div",{className:"flex flex-row h-[calc(100vh-100px)] bg-[#e5e6e0] dark:bg-[#18181a] rounded-2xl border border-gray-300 dark:border-[#0e0f15]",children:[(0,a.jsx)("div",{className:"w-[calc(100%-250px)] sm:flex-1 overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-3 space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 [@media(min-width:1000px)]:grid-cols-2 gap-4",children:[(0,a.jsxs)("section",{className:"space-y-2 bg-[#f3f4ee] dark:bg-[#0e0f15] p-3 rounded-xl shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-lg bg-[#fafafa] text-[#0a0a0c] font-bold text-sm border border-gray-200 dark:border-[#18181a]",children:"1"}),(0,a.jsx)("h2",{className:"text-base font-bold dark:text-white",children:"Hook"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"file",accept:".txt",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){let e=new FileReader;e.onload=e=>{var t;let r=null===(t=e.target)||void 0===t?void 0:t.result;"string"==typeof r&&V(r)},e.readAsText(r)}},className:"hidden",id:"hook-file"}),(0,a.jsxs)("label",{htmlFor:"hook-file",className:"px-3 py-1.5 bg-[#202123] text-white rounded-lg hover:bg-[#202123]/90 transition-colors cursor-pointer flex items-center gap-2 text-sm font-normal",children:[(0,a.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M3 14v5a2 2 0 002 2h14a2 2 0 002-2v-5M12 3v12M5 10l7-7 7 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Load"]})]})]}),(0,a.jsx)(i,{value:z,onChange:e=>V(e.target.value),placeholder:"Enter your hook here or load from a text file..",className:"min-h-[150px] dark:bg-[#18181a] dark:text-white dark:border-[#0e0f15] dark:placeholder:text-gray-400",maxLength:500}),(0,a.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,a.jsx)("div",{onClick:()=>{G(new Set([1])),q(1)},className:"flex-1 flex items-center justify-center p-4 rounded-xl cursor-pointer transition-all ".concat(B.has(1)?"bg-[#5465ff] text-white dark:bg-[#fafafa]":"bg-white/50 hover:bg-white/70 dark:bg-[#18181a] dark:hover:bg-[#18191C] dark:text-white"),children:(0,a.jsx)("div",{className:"text-sm font-semibold ".concat(B.has(1)?"text-white dark:!text-[#0a0a0c]":"text-gray-700 dark:text-white"),children:"Normal"})}),(0,a.jsx)("div",{onClick:()=>{G(new Set([2])),q(2)},className:"flex-1 flex items-center justify-center p-4 rounded-xl cursor-pointer transition-all ".concat(B.has(2)?"bg-[#5465ff] text-white dark:bg-[#fafafa]":"bg-white/50 hover:bg-white/70 dark:bg-[#18181a] dark:hover:bg-[#18191C] dark:text-white"),children:(0,a.jsx)("div",{className:"text-sm font-semibold ".concat(B.has(2)?"text-white dark:!text-[#0a0a0c]":"text-gray-700 dark:text-white"),children:"Background"})})]})]}),(0,a.jsxs)("section",{className:"space-y-2 bg-[#f3f4ee] dark:bg-[#0e0f15] p-3 rounded-xl shadow-sm",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-lg bg-[#fafafa] text-[#0a0a0c] font-bold text-sm border border-gray-200 dark:border-[#18181a]",children:"2"}),(0,a.jsx)("h2",{className:"text-base font-bold dark:text-white",children:"Music"})]})}),J?(0,a.jsx)("div",{className:"h-[200px] flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#5465ff]"})}):0===U.length?(0,a.jsx)("div",{className:"h-[200px] flex items-center justify-start pl-4 text-gray-500 dark:text-gray-400",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"No music available"}),(0,a.jsx)("p",{className:"text-sm mt-2",children:"Add music in the Music page first"})]})}):(0,a.jsx)(c,{className:"flex-1",children:(0,a.jsx)("div",{className:"py-2 space-y-2",children:U.map(e=>(0,a.jsxs)("div",{onClick:()=>F((null==O?void 0:O.id)===e.id?null:e),className:"flex items-center gap-3 p-2 pl-3 rounded-xl cursor-pointer transition-all ".concat((null==O?void 0:O.id)===e.id?"bg-[#5465ff] text-white dark:bg-[#fafafa]":"bg-white/50 hover:bg-white/70 dark:bg-[#18181a] dark:hover:bg-[#18191C] dark:text-white"),children:[(0,a.jsxs)("div",{className:"relative w-10 h-10 [@media(min-width:1000px)]:w-12 [@media(min-width:1000px)]:h-12 flex-shrink-0",children:[e.cover_url?(0,a.jsx)(y(),{src:e.cover_url,alt:e.title,layout:"fill",className:"object-cover rounded-md",sizes:"(max-width: 1000px) 40px, 48px"}):(0,a.jsx)("div",{className:"w-full h-full bg-gray-200 dark:bg-[#18181a] rounded-md flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"h-5 w-5 [@media(min-width:1000px)]:h-6 [@media(min-width:1000px)]:w-6 text-gray-500"})}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),e0(e)},className:"absolute inset-0 flex items-center justify-center bg-black/30 rounded-md ".concat(K===e.id?"opacity-100":"opacity-0 hover:opacity-100"),children:K===e.id?(0,a.jsx)(h.Z,{className:"h-5 w-5 [@media(min-width:1000px)]:h-6 [@media(min-width:1000px)]:w-6 text-white"}):(0,a.jsx)(f.Z,{className:"h-5 w-5 [@media(min-width:1000px)]:h-6 [@media(min-width:1000px)]:w-6 text-white"})})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium truncate ".concat((null==O?void 0:O.id)===e.id?"text-white dark:!text-[#0a0a0c]":"text-gray-700 dark:text-white"),children:e.title}),(0,a.jsxs)("p",{className:"text-xs truncate ".concat((null==O?void 0:O.id)===e.id?"text-white/80 dark:!text-[#0a0a0c]/80":"text-gray-500 dark:text-gray-300"),children:[e.artist," â€¢ ",S(e.duration)]})]})]},e.id))})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 [@media(min-width:1000px)]:grid-cols-2 gap-4",children:[(0,a.jsxs)("section",{className:"space-y-2 bg-[#f3f4ee] dark:bg-[#0e0f15] p-3 rounded-xl shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-lg bg-[#fafafa] text-[#0a0a0c] font-bold text-sm border border-gray-200 dark:border-[#18181a]",children:"3"}),(0,a.jsx)("h2",{className:"text-base font-bold dark:text-white",children:"Part 1"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"10MB max"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"file",accept:"image/*,video/*",onChange:e9,className:"hidden",id:"template-file",disabled:eV}),(0,a.jsxs)("label",{htmlFor:"template-file",className:"px-3 py-1.5 bg-[#202123] text-white rounded-lg hover:bg-[#202123]/90 transition-colors cursor-pointer flex items-center gap-2 text-sm font-normal ".concat(eV?"opacity-50 cursor-not-allowed":""),children:[(0,a.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M3 14v5a2 2 0 002 2h14a2 2 0 002-2v-5M12 3v12M5 10l7-7 7 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),eV?"Uploading...":"Upload"]})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 mb-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("div",{className:"flex justify-center mt-auto pt-4 mb-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("input",{type:"number",min:"2",max:"29",value:ee.min,onChange:e=>{let t=Number(e.target.value);t>=2&&t<ee.max&&et(e=>({min:t,max:e.max}))},className:"w-12 h-7 px-1 border border-gray-300 dark:border-[#0e0f15] dark:bg-[#18181a] dark:text-white rounded-md text-center text-sm"}),(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400 text-xs",children:"-"}),(0,a.jsx)("input",{type:"number",min:"3",max:"30",value:ee.max,onChange:e=>{let t=Number(e.target.value);t<=30&&t>ee.min&&et(e=>({min:e.min,max:t}))},className:"w-12 h-7 px-1 border border-gray-300 dark:border-[#0e0f15] dark:bg-[#18181a] dark:text-white rounded-md text-center text-sm"}),(0,a.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-300 ml-1",children:"Seconds"})]})})}),(0,a.jsx)("div",{className:"flex justify-center gap-1",children:(0,a.jsx)("div",{className:"flex flex-col items-center gap-2",children:(0,a.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,a.jsx)("button",{onClick:e=>e2("top",e),className:"flex flex-col items-center px-3 py-2 rounded-md ".concat("top"===ex?"bg-[#5465ff] text-white dark:bg-[#fafafa] dark:text-[#0a0a0c]":"bg-black/10 hover:bg-black/20 text-gray-700 dark:bg-[#18181a] dark:hover:bg-[#18191C] dark:text-white"," transition-colors"),title:"Afficher le haut de l'image/vid\xe9o",children:(0,a.jsx)("svg",{className:"w-4 h-4 ".concat("top"===ex&&"dark:text-[#0a0a0c]"),viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M4 5h16M4 9h16M10 13h4m-4 4h4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,a.jsx)("button",{onClick:e=>e2("center",e),className:"flex flex-col items-center px-3 py-2 rounded-md ".concat("center"===ex?"bg-[#5465ff] text-white dark:bg-[#fafafa] dark:text-[#0a0a0c]":"bg-black/10 hover:bg-black/20 text-gray-700 dark:bg-[#18181a] dark:hover:bg-[#18191C] dark:text-white"," transition-colors"),title:"Centrer l'image/vid\xe9o",children:(0,a.jsx)("svg",{className:"w-4 h-4 ".concat("center"===ex&&"dark:text-[#0a0a0c]"),viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M4 9h16M4 12h16M4 15h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,a.jsx)("button",{onClick:e=>e2("bottom",e),className:"flex flex-col items-center px-3 py-2 rounded-md ".concat("bottom"===ex?"bg-[#5465ff] text-white dark:bg-[#fafafa] dark:text-[#0a0a0c]":"bg-black/10 hover:bg-black/20 text-gray-700 dark:bg-[#18181a] dark:hover:bg-[#18191C] dark:text-white"," transition-colors"),title:"Afficher le bas de l'image/vid\xe9o",children:(0,a.jsx)("svg",{className:"w-4 h-4 ".concat("bottom"===ex&&"dark:text-[#0a0a0c]"),viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M10 7h4m-4 4h4M4 15h16M4 19h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})})}),(0,a.jsx)("div",{className:"pb-0.3"})]}),0!==eJ.length||eW?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 max-w-[170px] mx-auto",children:[eW&&(0,a.jsx)("div",{onClick:()=>R(eW.id),className:"relative aspect-[9/16] rounded-lg overflow-hidden cursor-pointer border-2 ".concat(I===eW.id?"bg-[#5465ff]/10 border-[#5465ff] ring-2 ring-[#5465ff]":"border-gray-200 hover:border-gray-300 dark:border-[#0e0f15] dark:hover:border-[#27272A]"),children:(0,a.jsx)("div",{className:"relative w-full h-full",children:(0,a.jsx)(_,{template:{url:eW.url,type:eW.type||"image"},alt:"Default Template",position:ex})})},eW.id),e$.map(e=>(0,a.jsxs)("div",{onClick:()=>R(e.id),className:"relative aspect-[9/16] rounded-lg overflow-hidden cursor-pointer border-2 group ".concat(I===e.id?"bg-[#5465ff]/10 border-[#5465ff] ring-2 ring-[#5465ff]":"border-gray-200 hover:border-gray-300 dark:border-[#0e0f15] dark:hover:border-[#27272A]"),children:[(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),tt()},className:"absolute top-1 right-1 z-10 opacity-0 group-hover:opacity-100 transition-opacity bg-red-500 hover:bg-red-600 text-white rounded-full p-1",title:"Delete template",children:(0,a.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M6 18L18 6M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,a.jsx)("div",{className:"relative w-full h-full",children:(0,a.jsx)(_,{template:{url:e.url,type:e.type},alt:"Template ".concat(e.id),position:ex})})]},e.id))]})}):(0,a.jsx)("div",{className:"h-[200px] flex items-center justify-center text-center text-gray-500 dark:text-gray-400",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"No media uploaded"}),(0,a.jsx)("p",{className:"text-sm mt-2",children:"Upload 1 video or 1 image to continue"})]})})]}),(0,a.jsxs)("section",{className:"space-y-2 bg-[#f3f4ee] dark:bg-[#0e0f15] p-3 rounded-xl shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-lg bg-[#fafafa] text-[#0a0a0c] font-bold text-sm border border-gray-200 dark:border-[#18181a]",children:"4"}),(0,a.jsx)("h2",{className:"text-base font-bold dark:text-white",children:"Part 2"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{...eK(),children:[(0,a.jsx)("input",{...eX()}),(0,a.jsxs)("button",{className:"px-3 py-1.5 bg-[#202123] text-white rounded-lg hover:bg-[#202123]/90 transition-colors text-sm font-normal flex items-center gap-2",children:[(0,a.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M3 14v5a2 2 0 002 2h14a2 2 0 002-2v-5M12 3v12M5 10l7-7 7 7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Upload"]})]}),eo.length>0&&(0,a.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[eo.length,"/50"]})]})]}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("div",{className:"flex justify-center mt-auto pt-4 mb-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("input",{type:"number",min:"2",max:"29",value:er.min,onChange:e=>{let t=Number(e.target.value);t>=2&&t<er.max&&ea(e=>({min:t,max:e.max}))},className:"w-12 h-7 px-1 border border-gray-300 dark:border-[#0e0f15] dark:bg-[#18181a] dark:text-white rounded-md text-center text-sm"}),(0,a.jsx)("span",{className:"text-gray-500 dark:text-gray-400 text-xs",children:"-"}),(0,a.jsx)("input",{type:"number",min:"3",max:"30",value:er.max,onChange:e=>{let t=Number(e.target.value);t<=30&&t>er.min&&ea(e=>({min:e.min,max:t}))},className:"w-12 h-7 px-1 border border-gray-300 dark:border-[#0e0f15] dark:bg-[#18181a] dark:text-white rounded-md text-center text-sm"}),(0,a.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-300 ml-1",children:"Seconds"})]})})}),0===eo.length?(0,a.jsx)("div",{className:"h-[200px] flex items-center justify-center text-center text-gray-500 dark:text-gray-400",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:"No media uploaded"}),(0,a.jsx)("p",{className:"text-sm mt-2",children:"Upload videos or images to continue (50 max)"})]})}):(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[es.size>=2&&(0,a.jsx)("button",{onClick:()=>{Array.from(es).sort((e,t)=>t-e).forEach(e=>{te(e)}),ei(new Set)},className:"text-red-500 hover:text-red-600 transition-colors",title:"Delete selected medias",children:(0,a.jsx)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M3 6h18M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2m3 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6h14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,a.jsx)("button",{onClick:()=>{es.size===eo.length?ei(new Set):ei(new Set(eo.map((e,t)=>t)))},className:"text-xs text-[#5465ff] hover:underline dark:text-[#f8d4eb]",children:es.size===eo.length?"Deselect All":"Select All"})]})}),(0,a.jsx)(c,{className:"h-[200px] w-full",children:(0,a.jsx)("div",{className:"grid grid-cols-5 gap-2 p-1 min-w-[200px]",children:eo.map((e,t)=>(0,a.jsxs)("div",{onClick:()=>e1(t),className:"relative w-10 aspect-[9/16] rounded-lg overflow-hidden cursor-pointer border-2 group ".concat(es.has(t)?"bg-[#5465ff]/10 border-[#5465ff] ring-2 ring-[#5465ff] dark:bg-[#5465ff]/10 dark:border-[#5465ff] dark:ring-[#5465ff]":"border-transparent hover:border-gray-500 dark:hover:border-gray-300"),children:[(0,a.jsx)("button",{onClick:e=>{e.stopPropagation(),te(t)},className:"absolute top-1 right-1 z-10 opacity-0 group-hover:opacity-100 transition-opacity bg-red-500 hover:bg-red-600 text-white rounded-full p-1",title:"Delete media",children:(0,a.jsx)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M6 18L18 6M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,a.jsx)("div",{className:"relative w-full h-full",children:e.url?(0,a.jsx)("div",{className:"relative w-full h-full",children:"video"===e.type?(0,a.jsx)("video",{id:"video-".concat(t),src:e.url,className:"w-full h-full object-cover",preload:"metadata",autoPlay:!0,muted:!0,loop:!0}):(0,a.jsx)(y(),{src:e.url,alt:"Media ".concat(t+1),className:"w-full h-full object-cover",layout:"fill"})}):(0,a.jsxs)("div",{className:"text-center p-2",children:[(0,a.jsx)("p",{className:"text-xs font-medium truncate dark:text-white",children:e.file.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"video"===e.type?S(e.duration):"5s"})]})})]},t))})})]})]})]}),(0,a.jsx)("div",{className:"flex flex-col items-center justify-center mt-8 mb-4",children:(0,a.jsx)(l.Button,{onClick:e6,disabled:!I||0===es.size||!O||!z||ev,className:"w-64 h-12 text-lg font-semibold bg-[#5564ff] hover:bg-[#5564ff]/90 text-white",children:ev?(0,a.jsx)("div",{className:"flex items-center justify-center w-full",children:(0,a.jsx)("span",{children:"Generating..."})}):"Create ".concat(z.split("\n").filter(e=>""!==e.trim()).length," Videos")})}),ev&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-[#18181a] rounded-xl shadow-xl p-8 max-w-md w-full mx-4 transform transition-all",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-semibold dark:text-white",children:"Generating Videos"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-300",children:"Please wait while your videos are being created"})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsxs)("span",{className:"text-3xl font-bold text-[#5465ff]",children:[Math.round(eA),"%"]})})]}),(0,a.jsx)("div",{className:"relative w-full h-6 bg-gray-100 dark:bg-[#0e0f15] rounded-full overflow-hidden mb-4",children:(0,a.jsx)("div",{className:"absolute left-0 top-0 h-full bg-[#5465ff] transition-all duration-300 rounded-full",style:{width:"".concat(eA,"%"),transition:eA<90?"width 0.5s ease-in-out":"none"}})}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-[#5465ff] rounded-full animate-pulse"}),(0,a.jsxs)("span",{children:["Processing video ",ej+1," of ",eN]})]}),(0,a.jsxs)("span",{className:"font-medium",children:[ej,"/",eN," videos"]})]}),(0,a.jsx)("div",{className:"mt-4 text-sm text-gray-500 dark:text-gray-400",children:eA<90?(0,a.jsx)("div",{className:"text-center",children:0===eA?"Calculating estimated time...":(0,a.jsxs)(a.Fragment,{children:["Estimated time remaining: ",Math.ceil((eN-ej)*(I?A(null!==(n=null===(e=eJ.find(e=>e.id===I))||void 0===e?void 0:e.size)&&void 0!==n?n:1048576,eo.reduce((e,t,r,a)=>{var o;let{length:l}=a;return e+((null===(o=t.file)||void 0===o?void 0:o.size)||0)/l},0)):10)/60)," minutes"]})}):(0,a.jsx)("div",{className:"text-center",children:"Finalizing video generation..."})})]})}),eH&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center",children:(0,a.jsx)("div",{className:"bg-white dark:bg-[#18181a] rounded-xl shadow-xl p-8 max-w-md w-full mx-4 transform transition-all",style:{animation:"fadeInScale 0.5s ease-out"},children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsx)("div",{className:"w-24 h-24 rounded-full bg-[#5465ff] flex items-center justify-center mb-6",style:{animation:"bounce 2s ease"},children:(0,a.jsx)("svg",{className:"w-16 h-16 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})})}),(0,a.jsx)("h3",{className:"text-2xl font-bold text-center mb-2 dark:text-white",children:"Generation Complete!"}),(0,a.jsx)("p",{className:"text-center text-gray-500 dark:text-gray-300 mb-4",children:"All your videos have been successfully created"}),(0,a.jsx)("div",{className:"w-full bg-gray-100 dark:bg-[#0e0f15] rounded-full h-2 mb-4",children:(0,a.jsx)("div",{className:"bg-[#5465ff] h-2 rounded-full",style:{animation:"progress 1s ease-in-out forwards"}})})]})})}),eQ&&!ev&&eS.length>0&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center",children:(0,a.jsx)("div",{className:"bg-white dark:bg-[#18181a] rounded-xl shadow-xl p-8 max-w-md w-full mx-4 border border-gray-300 dark:border-gray-700",children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsxs)("h3",{className:"text-2xl font-bold text-center mb-4 dark:text-white",children:["Your ",eS.length," videos are ready !"]}),(0,a.jsx)("p",{className:"text-center text-gray-500 dark:text-gray-300 mb-6",children:"What would you like to do next ?"}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 w-full",children:[(0,a.jsxs)("button",{onClick:e7,className:"px-6 py-3 bg-gradient-to-r from-[#f8d4eb] via-[#ce7acb] to-[#e9bcba] text-[#0a0a0c] rounded-lg font-medium flex-1 hover:opacity-90 transition-colors duration-200 flex items-center justify-center gap-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download All (",eS.length," vid\xe9os)"]}),(0,a.jsx)("button",{onClick:()=>{eZ(!1)},className:"px-6 py-3 border border-gray-300 dark:border-[#0e0f15] text-gray-700 dark:text-white rounded-lg font-medium flex-1 hover:bg-gray-50 dark:hover:bg-[#18191C] transition-colors duration-200",children:"Close"})]})]})})}),eT&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"relative w-full max-w-4xl",children:[(0,a.jsx)("button",{onClick:()=>eL(null),className:"absolute -top-10 right-0 text-white hover:text-gray-300",children:"Close"}),(0,a.jsx)("video",{className:"w-full rounded-lg",src:eT,controls:!0,autoPlay:!0,children:"Your browser does not support the video tag."})]})}),eC&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-[#18181a] rounded-2xl p-6 max-w-2xl w-full mx-4 max-h-[80vh] flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold dark:text-white",children:"Vid\xe9os g\xe9n\xe9r\xe9es"}),(0,a.jsx)("button",{onClick:()=>eM(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-[#18191C] rounded-lg dark:text-white",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,a.jsx)("div",{className:"grid gap-4",children:eS.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-[#0e0f15] rounded-xl",children:[(0,a.jsxs)("span",{className:"font-medium dark:text-white",children:["Vid\xe9o ",t+1]}),(0,a.jsx)("button",{onClick:()=>e8(e),className:"px-4 py-2 bg-[#5465ff] text-white rounded-lg hover:bg-[#5465ff]/90 transition-colors",children:"T\xe9l\xe9charger"})]},e))})}),(0,a.jsxs)("div",{className:"mt-6 flex justify-end gap-4",children:[(0,a.jsx)("button",{onClick:()=>eM(!1),className:"px-6 py-3 bg-gray-100 text-gray-700 rounded-xl hover:bg-gray-200 transition-colors",children:"Fermer"}),(0,a.jsxs)("button",{onClick:e7,className:"px-6 py-3 bg-[#5465ff] text-white rounded-xl hover:bg-[#5465ff]/90 transition-colors",children:["Tout t\xe9l\xe9charger (",eS.length," vid\xe9os)"]})]})]})})]})}),(0,a.jsx)("div",{className:"w-[250px] sm:w-[250px] md:w-[300px] lg:w-[350px] xl:w-[400px] p-3 sm:p-4 xl:p-6 bg-[#f3f4ee] dark:bg-[#18181A] flex-col items-center justify-center border-l border-gray-200 dark:border-[#0e0f15] flex",children:(0,a.jsxs)("div",{className:"w-full max-w-[220px] md:max-w-[280px] xl:max-w-[320px]",children:[(0,a.jsx)("div",{className:"aspect-[9/16] rounded-2xl bg-white dark:bg-[#18181A] shadow-lg overflow-hidden relative",children:I?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_,{template:{url:I===(null==eW?void 0:eW.id)?eW.url:(null===(t=eJ.find(e=>e.id===I))||void 0===t?void 0:t.url)||"",type:I===(null==eW?void 0:eW.id)?eW.type||"image":(null===(r=eJ.find(e=>e.id===I))||void 0===r?void 0:r.type)||"image"},alt:"Preview",position:ex}),z&&(0,a.jsx)("canvas",{ref:eR,className:"absolute inset-0 w-full h-full",style:{pointerEvents:"none"}})]}):(0,a.jsxs)("div",{className:"w-full h-full relative",children:[(0,a.jsx)(y(),{src:"/preview.jpg",alt:"Preview background",layout:"fill",objectFit:"cover",className:"absolute inset-0"}),(0,a.jsx)("div",{className:"relative w-full h-full",children:(0,a.jsx)("canvas",{ref:eR,className:"absolute inset-0 w-full h-full",style:{pointerEvents:"none"}})})]})}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4 mt-2",children:[(0,a.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,a.jsx)("button",{onClick:e=>{1===H?eh({position:"top",offset:0}):eg({position:"top",offset:0})},className:"w-12 h-12 rounded-xl flex items-center justify-center transition-all ".concat((1===H?eu.position:ef.position)==="top"?"bg-[#5465ff] text-[#fafafa] dark:bg-[#fafafa] dark:text-[#0a0a0c]":"bg-white hover:bg-white/80 dark:bg-[#0e0f15] dark:hover:bg-[#18191C] dark:text-white"),children:(0,a.jsx)("svg",{className:"w-6 h-6 ".concat((1===H?eu.position:ef.position)==="top"&&"dark:text-[#0a0a0c]"),viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M4 5h16M4 9h16M10 13h4m-4 4h4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,a.jsx)("button",{onClick:e=>{1===H?eh({position:"middle",offset:0}):eg({position:"middle",offset:0})},className:"w-12 h-12 rounded-xl flex items-center justify-center transition-all ".concat((1===H?eu.position:ef.position)==="middle"?"bg-[#5465ff] text-[#fafafa] dark:bg-[#fafafa] dark:text-[#0a0a0c]":"bg-white hover:bg-white/80 dark:bg-[#0e0f15] dark:hover:bg-[#18191C] dark:text-white"),children:(0,a.jsx)("svg",{className:"w-6 h-6 ".concat((1===H?eu.position:ef.position)==="middle"&&"dark:text-[#0a0a0c]"),viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M4 9h16M4 12h16M4 15h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[z&&(0,a.jsx)(l.Button,{onClick:async()=>{try{let e=eY();if(""===e.trim()){j.Am.info("Veuillez d'abord saisir un hook");return}let t=await fetch("/api/create-hook-preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,style:H,position:1===H?eu.position:ef.position,offset:1===H?eu.offset:ef.offset})});if(!t.ok)throw Error("Failed to create hook preview");let r=await t.blob(),a=URL.createObjectURL(r);window.open(a,"_blank")}catch(e){console.error("Error creating hook preview:",e)}},className:"bg-[#202123] hover:bg-[#202123]/90 text-white",size:"sm",children:"Test Hook"}),(0,a.jsx)("button",{onClick:()=>{1===H?eh(e=>({...e,offset:Math.max(e.offset-5,-50)})):eg(e=>({...e,offset:Math.max(e.offset-5,-50)}))},className:"w-8 h-8 rounded-lg bg-white hover:bg-white/80 dark:bg-[#0e0f15] dark:hover:bg-[#18191C] dark:text-white flex items-center justify-center transition-all","aria-label":"Move text up",children:(0,a.jsx)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M12 20V4m0 0l-6 6m6-6l6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,a.jsx)("button",{onClick:()=>{1===H?eh(e=>({...e,offset:Math.min(e.offset+5,50)})):eg(e=>({...e,offset:Math.min(e.offset+5,50)}))},className:"w-8 h-8 rounded-lg bg-white hover:bg-white/80 dark:bg-[#0e0f15] dark:hover:bg-[#18191C] dark:text-white flex items-center justify-center transition-all","aria-label":"Move text down",children:(0,a.jsx)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M12 4v16m0 0l-6-6m6 6l6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]})]})})]})]})})})]})}},8312:function(e,t,r){"use strict";r.d(t,{V:function(){return s}});var a=r(1101),o=r.n(a),l=r(2599);async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bluum_videos.zip";if(!e||0===e.length){console.error("Aucune vid\xe9o \xe0 t\xe9l\xe9charger");return}console.log("D\xe9but du processus de t\xe9l\xe9chargement pour ".concat(e.length," vid\xe9os")),console.log("Vid\xe9os \xe0 t\xe9l\xe9charger:",e);try{if(!o())throw Error("JSZip n'est pas disponible");if(!l.saveAs)throw Error("saveAs n'est pas disponible");let r=new(o());console.log("Instance JSZip cr\xe9\xe9e");let a=0,s=e.length,i=r.folder("videos");if(!i)throw Error("Impossible de cr\xe9er le dossier dans le ZIP");console.log('Dossier "videos" cr\xe9\xe9 dans le ZIP');let n=e.map(async(e,t)=>{try{console.log("T\xe9l\xe9chargement de la vid\xe9o ".concat(t+1,"/").concat(s,": ").concat(e.fileName," depuis ").concat(e.path));let r=await fetch(e.path);if(!r.ok)throw Error("\xc9chec du t\xe9l\xe9chargement de la vid\xe9o ".concat(e.fileName,": ").concat(r.status," ").concat(r.statusText));console.log("Vid\xe9o ".concat(t+1," r\xe9cup\xe9r\xe9e avec succ\xe8s, conversion en blob..."));let o=await r.blob();console.log("Taille du blob pour ".concat(e.fileName,": ").concat(o.size," octets"));let l=function(e,t){let r=e.lastIndexOf("."),a=r>0?e.substring(0,r):e,o=r>0?e.substring(r):"";return"".concat(a,"_").concat(t+1).concat(o)}(e.fileName,t);i.file(l,o),a++,console.log("T\xe9l\xe9chargement ".concat(a,"/").concat(s,": ").concat(e.fileName," ajout\xe9 au ZIP"))}catch(t){console.error("Erreur lors du t\xe9l\xe9chargement de ".concat(e.fileName,":"),t)}});if(console.log("Attente de tous les t\xe9l\xe9chargements..."),await Promise.all(n),0===a)throw Error("Aucune vid\xe9o n'a pu \xeatre t\xe9l\xe9charg\xe9e");console.log("G\xe9n\xe9ration du fichier ZIP...");let c=await r.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:5}});console.log("ZIP g\xe9n\xe9r\xe9 avec succ\xe8s, taille: ".concat(c.size," octets. T\xe9l\xe9chargement...")),(0,l.saveAs)(c,t),console.log("T\xe9l\xe9chargement du ZIP lanc\xe9")}catch(e){throw console.error("Erreur d\xe9taill\xe9e lors de la cr\xe9ation du ZIP:",e),e}}}},function(e){e.O(0,[565,233,799,999,743,992,726,426,951,971,69,744],function(){return e(e.s=2565)}),_N_E=e.O()}]);