"use strict";(()=>{var e={};e.id=821,e.ids=[821],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78018:e=>{e.exports=require("puppeteer")},14300:e=>{e.exports=require("buffer")},32081:e=>{e.exports=require("child_process")},57147:e=>{e.exports=require("fs")},73292:e=>{e.exports=require("fs/promises")},72254:e=>{e.exports=require("node:buffer")},87561:e=>{e.exports=require("node:fs")},88849:e=>{e.exports=require("node:http")},22286:e=>{e.exports=require("node:https")},87503:e=>{e.exports=require("node:net")},49411:e=>{e.exports=require("node:path")},97742:e=>{e.exports=require("node:process")},84492:e=>{e.exports=require("node:stream")},72477:e=>{e.exports=require("node:stream/web")},41041:e=>{e.exports=require("node:url")},47261:e=>{e.exports=require("node:util")},65628:e=>{e.exports=require("node:zlib")},71017:e=>{e.exports=require("path")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},71267:e=>{e.exports=require("worker_threads")},77824:(e,o,r)=>{r.r(o),r.d(o,{headerHooks:()=>S,originalPathname:()=>k,patchFetch:()=>M,requestAsyncStorage:()=>I,routeModule:()=>U,serverHooks:()=>L,staticGenerationAsyncStorage:()=>j,staticGenerationBailout:()=>N});var t={};r.r(t),r.d(t,{POST:()=>A,dynamic:()=>c.D,generateStaticParams:()=>c.U,runtime:()=>_});var i=r(95419),s=r(69108),a=r(99678),l=r(78070),n=r(81832),c=r(70462);let u=null,p=null,d=null,g=null,m=null,f=null;try{u=r(71017),p=r(73292),d=r(57147),g=r(32081),m=r(73837),r(57310),r.e(511).then(r.bind(r,54511)).then(e=>{f=e.default})}catch(e){console.error("Erreur lors de l'import des modules natifs:",e)}let $=(...e)=>u?u.join(...e):"",h=async(e,o)=>p?p.mkdir(e,o):null,x=async(e,o)=>p?p.writeFile(e,o):null,v=async e=>p?p.readFile(e):Buffer.from(""),w=e=>!!d&&d.existsSync(e),y=e=>d?d.statSync(e):{size:0},b=e=>d?d.readdirSync(e):[],D=(e,o)=>d?d.writeFileSync(e,o):null,P=g?g.exec:()=>{},E=m?m.promisify(P):async()=>({stdout:"",stderr:""}),_="nodejs";async function R(e){w(e)||await h(e,{recursive:!0})}function F(e,o){return Math.round((Math.random()*(o-e)+e)*10)/10}function T(e){return[".jpg",".jpeg",".png",".gif",".webp",".bmp"].includes(u?u.extname(e).toLowerCase():"")}async function A(e){try{let t=await e.json();console.log("\uD83D\uDD34 D\xc9MARRAGE DE LA CR\xc9ATION DE VID\xc9O - Timestamp:",Date.now()),console.log("\uD83D\uDD0D D\xc9TAILS DES MEDIAS RE\xc7US:"),console.log("\uD83D\uDD38 Part1 (m\xe9dia upload\xe9) type:",t.part1?.type),console.log("\uD83D\uDD38 Part2 type:",t.part2?.type),console.log("\uD83D\uDD38 Part1 URL (premiers 50 car.):",t.part1?.url?.substring(0,50)+"..."),console.log("\uD83D\uDD38 Part2 URL (premiers 50 car.):",t.part2?.url?.substring(0,50)+"...");let i="true"===process.env.NETLIFY;if(console.log("Environnement Netlify d\xe9tect\xe9:",i),i){console.log("Redirection vers la fonction Netlify video-processing");try{let e=await fetch("/.netlify/functions/video-processing",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({operation:"generateVideo",options:t})});if(!e.ok){let o=await e.text();return console.error("Erreur de la fonction Netlify:",o),l.Z.json({success:!1,error:`Erreur du service Netlify: ${o||e.statusText}`},{status:e.status})}let o=await e.json();return console.log("R\xe9ponse de la fonction Netlify:",o),l.Z.json(o)}catch(e){return console.error("Erreur lors de l'appel \xe0 la fonction Netlify:",e),l.Z.json({success:!1,error:`Erreur de communication avec le service Netlify: ${e instanceof Error?e.message:"Erreur inconnue"}`},{status:500})}}let s=t.part1?.url?.startsWith("data:")||!1,a=s&&t.part1?.url?.includes("data:image"),c=s&&t.part1?.url?.includes("data:video"),p=t.part1?.url?.includes("local_storage")||!1;console.log("\uD83D\uDD0D ANALYSE URL PART 1:"),console.log("Est data:URL?",s),console.log("Est image?",a),console.log("Est vid\xe9o?",c),console.log("Est local_storage?",p);let d=t.hook||{},g=t.part1||{url:"",type:"image",duration:{min:4,max:6}},m=Array.isArray(t.part2)?t.part2:[t.part2||{url:"",type:"image",duration:{min:3,max:6}}],h=t.song||{url:""};m.length>50&&(console.warn("Plus de 50 m\xe9dias d\xe9tect\xe9s pour Part 2. Limitation aux 50 premiers."),m.length=50);let P=parseFloat(t.part1?.duration?.min||"4"),_=parseFloat(t.part1?.duration?.max||"6"),A=parseFloat(t.part2Duration?.min||"3"),U=parseFloat(t.part2Duration?.max||"6");console.log("IMPORTANT - Dur\xe9es configur\xe9es:"),console.log(`Part 1: ${P}s - ${_}s`),console.log(`Part 2: ${A}s - ${U}s`),console.log(`Nombre de m\xe9dias Part 2: ${m.length}`);let I=F(P,_),j=m.map(()=>F(A,U));console.log("Dur\xe9es g\xe9n\xe9r\xe9es:"),console.log(`Part 1: ${I}s`),console.log("Part 2 (dur\xe9es individuelles):",j);let L=Math.floor(Math.random()*m.length),S=m[L],N=j[L];if(console.log(`M\xe9dia Part 2 s\xe9lectionn\xe9: index ${L}, dur\xe9e ${N}s`),console.log("IMPORTANT - Variables align\xe9es avec l'interface:"),console.log("part1:",g.type),console.log("part2:",S.type),console.log("song:",h),!g.url||""===g.url)return console.error("Aucun m\xe9dia upload\xe9 pour Part 1"),l.Z.json({success:!1,error:"No media uploaded. Upload videos or images to continue."},{status:400});if(!S.url||""===S.url)return console.error("Aucun m\xe9dia upload\xe9 pour Part 2"),l.Z.json({success:!1,error:"No media uploaded. Upload videos or images to continue."},{status:400});if(!h.url||""===h.url)return console.error("Aucune musique upload\xe9e"),l.Z.json({success:!1,error:"No music uploaded. Upload a music file to continue."},{status:400});let k=$(process.cwd(),"public","temp-videos");await R(k);let M=Date.now(),q=`video_${M}.mp4`,C=$(k,q),O=$(process.cwd(),"temp");async function o(e,o){try{if(console.log(`---D\xc9BUT TRAITEMENT URL [${o}]---`),console.log(`URL re\xe7ue pour ${o}:`,e.substring(0,50)+(e.length>50?"...":"")),e.startsWith("data:image")){console.log(`Data URL d'image d\xe9tect\xe9e pour ${o}`);try{let r=e.split("base64,");if(r.length>=2){let e=r[1],t=r[0].split(":")[1]?.split(";")[0]||"",i=".jpg";t.includes("png")?i=".png":t.includes("webp")&&(i=".webp");let s=Buffer.from(e,"base64"),a=$(O,`${o}_${M}${i}`);return D(a,s),console.log(`✅ Image sauvegard\xe9e \xe0: ${a}`),a}}catch(e){throw console.error(`Erreur lors du traitement de l'image upload\xe9e:`,e),e}}if("part2"===o&&e.startsWith("data:image")){console.log(`⭐ Traitement direct d'une image pour Part 2`);try{let r="",t="";if(e.includes("base64,")){let i=e.split("base64,");i.length>=2&&(r=i[1],t=i[0].split(":")[1]?.split(";")[0]||"",console.log(`Type MIME d\xe9tect\xe9 pour ${o}: ${t}`))}if(!r)throw Error("Format data URL invalide: impossible d'extraire les donn\xe9es");let i=".jpg";t.includes("jpeg")?i=".jpg":t.includes("png")?i=".png":t.includes("webp")&&(i=".webp");let s=Buffer.from(r,"base64");console.log(`Taille des donn\xe9es pour ${o}: ${s.length} octets`);let a=$(O,`${o}_image_${M}${i}`);return D(a,s),console.log(`⭐ Image Part 2 sauvegard\xe9e \xe0: ${a}`),a}catch(e){throw console.error("Erreur lors du traitement direct de l'image Part 2:",e),e}}if(e.startsWith("data:")){console.log(`URL data: d\xe9tect\xe9e pour ${o}, conversion en fichier`);try{let r="",t="";if(e.includes("base64,")){let i=e.split("base64,");i.length>=2&&(r=i[1],t=i[0].split(":")[1]?.split(";")[0]||"",console.log(`Type MIME d\xe9tect\xe9 pour ${o}: ${t}`))}if(!r)throw Error("Format data URL invalide: impossible d'extraire les donn\xe9es");let i=".jpg";t.includes("jpeg")?i=".jpg":t.includes("png")?i=".png":t.includes("webp")?i=".webp":t.includes("video")&&(i=".mp4");let s=Buffer.from(r,"base64");console.log(`Taille des donn\xe9es pour ${o}: ${s.length} octets`);let a=$(O,`${o}_${M}${i}`);return D(a,s),console.log(`✅ Fichier sauvegard\xe9 \xe0: ${a}`),a}catch(e){throw console.error(`Erreur lors du traitement de la data URL pour ${o}:`,e),e}}else if(e.startsWith("blob:")||e.includes("local_storage")){if(console.log(`URL ${e.substring(0,30)}... d\xe9tect\xe9e pour ${o}`),e.includes("local_storage"))try{console.log("⚠️ D\xc9PANNAGE: Listage de tous les fichiers du dossier temporaire");let r=b(O);console.log(`Fichiers dans ${O}:`,r),console.log(`URL compl\xe8te: ${e}`);let t="";if(e.includes("_IMG_")){let o=e.indexOf("_IMG_");o>0&&(t="IMG_"+e.substring(o+5),console.log(`Nom du fichier extrait: ${t}`))}else t=e.split("/").pop()||"",console.log(`Nom du fichier extrait: ${t}`);t||(t=e.split("/").pop()||"",console.log(`Fallback: utilisation de l'URL compl\xe8te comme nom de fichier: ${t}`));let i=[$(process.cwd(),"public","uploads",t||""),$(process.cwd(),"temp",t||""),$(O,t||""),$(process.cwd(),"public",t||"")];for(let e of(console.log("Recherche dans les dossiers suivants:"),i))console.log(`- ${e}`);for(let e of i)if(console.log(`V\xe9rification du chemin: ${e}`),w(e)){console.log(`Fichier trouv\xe9 \xe0 ${e}`);let r=await v(e),t=u?u.extname(e).toLowerCase()||".jpg":"",i=$(O,`${o}_${M}${t}`);if(await x(i,r),console.log(`Fichier local sauvegard\xe9 pour ${o} \xe0 ${i}`),t.match(/\.(mp4|mov|avi|webm)$/i)){console.log(`Suppression de l'audio pour la vid\xe9o ${o}`);let e=$(O,`${o}_noaudio_${M}${t}`);try{return await E(`ffmpeg -i "${i}" -c:v copy -an "${e}"`),console.log(`Audio supprim\xe9 pour ${o}, nouveau fichier: ${e}`),e}catch(e){console.error(`Erreur lors de la suppression de l'audio pour ${o}:`,e)}}return i}throw console.log(`⚠️ Aucun fichier trouv\xe9 pour ${o}`),Error(`Fichier non trouv\xe9 pour ${o}. Veuillez vous assurer que le m\xe9dia est correctement upload\xe9.`)}catch(o){throw console.error(`Erreur lors de la recherche du fichier local ${e}:`,o),o}throw Error(`Les URLs blob ne peuvent pas \xeatre trait\xe9es c\xf4t\xe9 serveur pour ${o}`)}else if(e.startsWith("/")){console.log(`URL locale d\xe9tect\xe9e pour ${o}: ${e}`);let r=$(process.cwd(),"public",e.slice(1));if(console.log(`Chemin absolu pour ${o}: ${r}`),!w(r))throw console.error(`Fichier local non trouv\xe9: ${r}`),Error(`Fichier local non trouv\xe9: ${r}`);if(("part1"===o||"part2"===o)&&r.match(/\.(mp4|mov|avi|webm)$/i)){console.log(`Suppression de l'audio pour la vid\xe9o ${o}`);let e=$(O,`${o}_noaudio_${M}${u?u.extname(r):".jpg"}`);try{return await E(`ffmpeg -i "${r}" -c:v copy -an "${e}"`),console.log(`Audio supprim\xe9 pour ${o}, nouveau fichier: ${e}`),e}catch(e){console.error(`Erreur lors de la suppression de l'audio pour ${o}:`,e)}}return r}else if(e.startsWith("http")){console.log(`URL HTTP d\xe9tect\xe9e pour ${o}: ${e.substring(0,30)}...`);let r=await f(e),t=await r.buffer(),i=".mp4",s=r.headers.get("content-type");s&&(s.includes("image/jpeg")?i=".jpg":s.includes("image/png")?i=".png":s.includes("image/gif")?i=".gif":s.includes("image/webp")?i=".webp":s.includes("video")?i=".mp4":s.includes("audio")&&(i=".mp3"));let a=$(O,`${o}_${M}${i}`);if(await x(a,t),console.log(`Fichier HTTP sauvegard\xe9 pour ${o} \xe0 ${a}`),("part1"===o||"part2"===o)&&".mp4"===i){console.log(`Suppression de l'audio pour la vid\xe9o ${o}`);let e=$(O,`${o}_noaudio_${M}${i}`);try{return await E(`ffmpeg -i "${a}" -c:v copy -an "${e}"`),console.log(`Audio supprim\xe9 pour ${o}, nouveau fichier: ${e}`),e}catch(e){console.error(`Erreur lors de la suppression de l'audio pour ${o}:`,e)}}return a}if(console.log(`URL inconnue pour ${o}, suppos\xe9e \xeatre un chemin de fichier: ${e}`),("part1"===o||"part2"===o)&&e.match(/\.(mp4|mov|avi|webm)$/i)){console.log(`Suppression de l'audio pour la vid\xe9o ${o}`);let r=$(O,`${o}_noaudio_${M}${u?u.extname(e):".jpg"}`);try{return await E(`ffmpeg -i "${e}" -c:v copy -an "${r}"`),console.log(`Audio supprim\xe9 pour ${o}, nouveau fichier: ${r}`),r}catch(e){console.error(`Erreur lors de la suppression de l'audio pour ${o}:`,e)}}return e}catch(r){throw console.error(`Erreur lors de la sauvegarde de l'URL ${e} pour ${o}:`,r),r}}await R(O),console.log("Sauvegarde des fichiers d'entr\xe9e..."),console.log("\uD83D\uDD0D V\xc9RIFICATION POUR PART 1:"),console.log("Part1 URL (30 premiers car.):",g.url.substring(0,30)),console.log("Part1 type:",g.type);let V=await o(g.url,"part1");console.log("\uD83D\uDD0D V\xc9RIFICATION POUR PART 2:"),console.log("Part2 URL (30 premiers car.):",S.url.substring(0,30)),console.log("Part2 type:",S.type);let B=S.url;B.startsWith("data:")||B.startsWith("http")||console.log("⚠️ URL Part2 non standard d\xe9tect\xe9e, v\xe9rification suppl\xe9mentaire requise");let G=await o(B,"part2"),W=await o(h.url,"song"),Z=async(e,o)=>{try{if(console.log(`-------- V\xc9RIFICATION FICHIER ${o}: ${e} --------`),w(e)&&y(e).size>0)return console.log(`Fichier ${o} existe et est valide: ${e}`),e;throw console.error(`Fichier ${o} invalide ou introuvable: ${e}`),Error(`Fichier ${o} invalide ou introuvable: ${e}`)}catch(e){throw console.error(`Erreur lors de la v\xe9rification du fichier ${o}:`,e),e}},H=await Z(V,"part1"),z=await Z(G,"part2"),J=await Z(W,"song"),Y=e=>e.replace(/\s+/g," ").trim(),X=Y(H),K=Y(z),Q=Y(J);console.log("Chemins des fichiers nettoy\xe9s:"),console.log("Part 1:",X),console.log("Part 2:",K),console.log("Song:",Q);let ee=T(X),eo=T(K),er=!1;try{let{stdout:e}=await E(`ffprobe -v error -select_streams a -show_entries stream=codec_type -of csv=p=0 "${Q}"`);er=e.trim().includes("audio"),console.log(`Le fichier song contient-il de l'audio ? ${er?"Oui":"Non"}`)}catch(e){console.error("Erreur lors de la v\xe9rification du flux audio:",e),er=!1}console.log(`Dimensions cibles pour la vid\xe9o: 1080x1920`),console.log(`Dur\xe9es des parties - Part 1: ${I}s, Part 2: ${N}s, Total: ${I+N}s`),console.log("V\xe9rification des fichiers d'entr\xe9e:"),console.log(`Part 1 (${ee?"Image":"Vid\xe9o"}): ${X}`),console.log(`Part 2 (${eo?"Image":"Vid\xe9o"}): ${K}`),console.log(`Song: ${Q}`);let et=$(O,`part1_scaled_${M}.mp4`),ei=$(O,`part2_scaled_${M}.mp4`),es="",ea="";ee?(console.log(`Conversion de l'image Part 1 en vid\xe9o de ${I}s`),es=`ffmpeg -loop 1 -i "${X}" -t ${I} -vf "scale=1080:1920:force_original_aspect_ratio=increase,crop=1080:1920:0:${"top"===g.position?"0":"bottom"===g.position?"ih-1920":"(ih-1920)/2"},setsar=1" -c:v libx264 -pix_fmt yuv420p -r 30 "${et}"`):(console.log(`Redimensionnement de la vid\xe9o Part 1 et limitation \xe0 ${I}s`),es=`ffmpeg -i "${X}" -t ${I} -vf "scale=1080:1920:force_original_aspect_ratio=increase,crop=1080:1920:0:${"top"===g.position?"0":"bottom"===g.position?"ih-1920":"(ih-1920)/2"},setsar=1" -c:v libx264 -pix_fmt yuv420p -r 30 "${et}"`),eo?(console.log(`Conversion de l'image Part 2 en vid\xe9o de ${N}s`),ea=`ffmpeg -loop 1 -i "${K}" -t ${N} -vf "scale=1080:1920:force_original_aspect_ratio=decrease,pad=1080:1920:(ow-iw)/2:(oh-ih)/2:color=black" -c:v libx264 -pix_fmt yuv420p -r 30 "${ei}"`):(console.log(`Redimensionnement de la vid\xe9o Part 2 \xe0 ${N}s`),ea=`ffmpeg -i "${K}" -t ${N} -vf "scale=1080:1920:force_original_aspect_ratio=decrease,pad=1080:1920:(ow-iw)/2:(oh-ih)/2:color=black" -c:v libx264 -pix_fmt yuv420p -r 30 "${ei}"`),console.log("Pr\xe9paration de Part 1..."),console.log("Executing FFmpeg command:",es),await E(es),console.log("Pr\xe9paration de Part 2..."),console.log("Executing FFmpeg command:",ea),await E(ea),console.log("APPROCHE DIRECTE: Concat\xe9nation directe dans l'ordre NORMAL");let el="";el=er?`ffmpeg -i "${et}" -i "${ei}" -i "${Q}" -filter_complex "[0:v][1:v]concat=n=2:v=1:a=0[outv];[2:a]aformat=sample_fmts=fltp:sample_rates=44100:channel_layouts=stereo[outa]" -map "[outv]" -map "[outa]" -c:v libx264 -c:a aac -shortest "${C}"`:`ffmpeg -i "${et}" -i "${ei}" -filter_complex "[0:v][1:v]concat=n=2:v=1:a=0[outv]" -map "[outv]" -c:v libx264 "${C}"`,console.log("ORDRE DE CONCAT\xc9NATION:"),console.log(`1er (Input 0): ${et} (Part 1)`),console.log(`2nd (Input 1): ${ei} (Part 2)`),console.log("Executing final FFmpeg command:",el);try{(0,n.updateProgress)(0);let{stdout:e,stderr:o}=await E(el);if(console.log("FFmpeg stdout:",e),console.log("FFmpeg stderr:",o),d&&d.text){console.log("Ajout du hook \xe0 la vid\xe9o...");let e=$(O,`hook_${M}.png`),o=r(78018),t=await o.launch({headless:!0}),i=await t.newPage();await i.setViewport({width:1080,height:1920,deviceScaleFactor:1}),d.style;let s=`
          font-size: 60px;
          line-height: 1.2;
          display: inline-block;
          width: 100%;
          max-width: 80%;
          margin: 0 auto;
          text-align: center;
          color: #fff;
          font-weight: normal;
          text-shadow: -2.8px -2.8px 0 #000, 2.8px -2.8px 0 #000, -2.8px 2.8px 0 #000, 2.8px 2.8px 0 #000;
          padding: 0.8rem 1.5rem 1rem 1.5rem;
          background: transparent;
          filter: none;
        `,a=`
          font-size: 65px;
          line-height: 1.2;
          display: inline;
          box-decoration-break: clone;
          background: #fff;
          padding: 0.1rem 1.5rem 0.75rem 1.5rem;
          filter: url('#goo');
          max-width: 80%;
          text-align: center;
          color: #000;
          font-weight: normal;
        `,l=`
          <html>
            <head>
              <style>
                :root {
                  --color-bg: transparent;
                  --font: 'TikTok Display Medium', -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
                }
                
                @font-face {
                  font-family: 'TikTok Display Medium';
                  src: url('${$(process.cwd(),"public/fonts/TikTokDisplayMedium.otf")}');
                  font-weight: normal;
                  font-style: normal;
                }

                body {
                  margin: 0;
                  width: 1080px;
                  height: 1920px;
                  display: flex;
                  align-items: ${"top"===d.position?"flex-start":"middle"===d.position?"center":"flex-end"};
                  justify-content: center;
                  padding: ${"top"===d.position?"250px":"bottom"===d.position?"200px":"0px"} 0;
                  background: var(--color-bg);
                  font-family: var(--font);
                }

                h1 {
                  width: 85%;
                  text-align: center;
                  margin: 0;
                  padding: 0;
                }

                .goo {
                  ${1===d.style?s:a}
                  transform: translateY(${d.offset}px);
                }

                .goo:focus {
                  outline: 0;
                }
              </style>
            </head>
            <body>
              <h1>
                <div class="goo">${d.text}</div>
              </h1>

              <svg style="visibility: hidden; position: absolute;" width="0" height="0" xmlns="http://www.w3.org/2000/svg" version="1.1">
                <defs>
                  <filter id="goo">
                    <feGaussianBlur in="SourceGraphic" stdDeviation="10" result="blur" />    
                    <feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 19 -9" result="goo" />
                    <feComposite in="SourceGraphic" in2="goo" operator="atop"/>
                  </filter>
                </defs>
              </svg>
            </body>
          </html>
        `;await i.setContent(l),await i.screenshot({path:e,omitBackground:!0,type:"png"}),await t.close(),console.log(`Image du hook g\xe9n\xe9r\xe9e: ${e}`);let n=$(process.cwd(),"public","generated",`video_with_hook_${M}.mp4`),c="0";"middle"===d.position?c="(H-h)/2":"bottom"===d.position&&(c="H-h-0");let u=8*d.offset;c=`${c}+${u}`;let p=1===d.style?"1.15":"1",g=`ffmpeg -i "${C}" -i "${e}" -filter_complex "[1:v]scale=iw*${p}:-1[overlay];[0:v][overlay]overlay=(W-w)/2:${c}:format=auto,format=yuv420p[outv]" -map "[outv]" -map 0:a -c:v libx264 -c:a copy "${n}"`;console.log("Executing overlay command:",g);let{stdout:m,stderr:f}=await E(g);console.log("FFmpeg overlay stdout:",m),console.log("FFmpeg overlay stderr:",f),await E(`mv "${n}" "${C}"`),console.log("Vid\xe9o avec hook remplac\xe9e")}(0,n.updateProgress)(100);let t=`/temp-videos/${q}`,i=Date.now()+9e5;try{let e=$(k,`${q}.meta.json`);await x(e,JSON.stringify({expires:i,created:Date.now()})),console.log(`Metadata stored for ${q}, expires in 15 minutes`)}catch(e){console.warn("Could not write video metadata file:",e)}return l.Z.json({success:!0,videoPath:t,expiresAt:i,part1Duration:I,part2Duration:N,totalDuration:I+N})}catch(e){return console.error("Error executing FFmpeg command:",e),l.Z.json({success:!1,error:e instanceof Error?e.message:"Unknown error"},{status:500})}}catch(e){return console.error("Error in create-video route:",e),l.Z.json({success:!1,error:e instanceof Error?e.message:"Unknown error"},{status:500})}}let U=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/create-video/route",pathname:"/api/create-video",filename:"route",bundlePath:"app/api/create-video/route"},resolvedPagePath:"/Users/twain/Bluum/BLUUM 1.2/Bluum_1.2/app/api/create-video/route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:I,staticGenerationAsyncStorage:j,serverHooks:L,headerHooks:S,staticGenerationBailout:N}=U,k="/api/create-video/route";function M(){return(0,a.patchFetch)({serverHooks:L,staticGenerationAsyncStorage:j})}},70462:(e,o,r)=>{r.d(o,{D:()=>t,U:()=>i});let t="force-static";function i(){return[]}},81832:(e,o,r)=>{async function t(e){try{await fetch("/api/progress",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({progress:e})})}catch(e){console.error("Failed to update progress:",e)}}r.r(o),r.d(o,{sendProgressToAPI:()=>t,updateProgress:()=>a});let i=0,s=[];function a(e){i=Math.min(100,Math.max(0,e)),s.forEach(e=>{try{e(i)}catch(e){console.error("Erreur lors de la notification de progression:",e)}})}}};var o=require("../../../webpack-runtime.js");o.C(e);var r=e=>o(o.s=e),t=o.X(0,[638,206],()=>r(77824));module.exports=t})();