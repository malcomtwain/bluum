(()=>{var e={};e.id=404,e.ids=[404],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},88993:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c});var s=r(50482),a=r(69108),l=r(62563),i=r.n(l),o=r(68300),n={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>o[e]);r.d(t,n);let c=["",{children:["music",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,23827)),"/Users/twain/Bluum/BLUUM 1.2/Bluum_1.2/app/music/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,60742)),"/Users/twain/Bluum/BLUUM 1.2/Bluum_1.2/app/layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,20429)),"/Users/twain/Bluum/BLUUM 1.2/Bluum_1.2/app/error.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,87984)),"/Users/twain/Bluum/BLUUM 1.2/Bluum_1.2/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,66542)),"/Users/twain/Bluum/BLUUM 1.2/Bluum_1.2/app/not-found.tsx"]}],d=["/Users/twain/Bluum/BLUUM 1.2/Bluum_1.2/app/music/page.tsx"],u="/music/page",x={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/music/page",pathname:"/music",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},62937:(e,t,r)=>{Promise.resolve().then(r.bind(r,32436))},32436:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j});var s=r(95344),a=r(55493),l=r(3380),i=r(97075);let o=(0,i.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var n=r(6058);let c=(0,i.Z)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var d=r(38271),u=r(48001),x=r(57320);let m=(0,i.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var p=r(89410),g=r(3729),h=r(8122),f=r(34755),v=r(29633),b=r(72829),y=r(8428);function j(){let{user:e}=(0,v.aF)(),t=(0,y.useRouter)(),{selectedSongs:r,addSong:i,removeSong:j,updateSong:w,clearSongs:k,cachedSongs:N,setCachedSongs:U}=(0,a.B)(),[_,P]=(0,g.useState)(null),[B,q]=(0,g.useState)(null),[M,$]=(0,g.useState)(!0),[C,E]=(0,g.useState)({}),[Z,F]=(0,g.useState)({artist:"",title:"",coverUrl:""}),A=(0,g.useRef)(null);(0,g.useEffect)(()=>{e&&"bluumfrerk@gmail.com"!==e.emailAddresses[0]?.emailAddress&&(f.toast.error("Vous n'avez pas acc\xe8s \xe0 cette page"),t.push("/create"))},[e,t]),(0,g.useEffect)(()=>{(async()=>{if(e)try{$(!0);let t=await (0,b.Bi)(e.id);k(),t.forEach(e=>{let t={id:e.id,url:e.url,title:e.title,artist:e.artist??void 0,duration:e.duration,coverUrl:e.cover_url??void 0,cover_url:e.cover_url??void 0};i(t)}),U(t)}catch(e){console.error("Error loading songs:",e),f.toast.error("Failed to load your songs")}finally{$(!1)}})()},[e,i,k,U]);let S=(e,t)=>{_===e?(A.current?.pause(),P(null)):(A.current&&A.current.pause(),A.current=new Audio(t),A.current.play(),P(e))},z=e=>{let t=r.find(t=>t.id===e);t&&(F({artist:t.artist||"",title:t.title||t.id,coverUrl:t.coverUrl||""}),q(e))},L=async()=>{if(B&&e)try{await (0,b.$g)(B,{title:Z.title,artist:Z.artist,cover_url:Z.coverUrl}),w(B,{title:Z.title,artist:Z.artist,coverUrl:Z.coverUrl}),q(null),f.toast.success("Song details updated")}catch(e){console.error("Error updating song:",e),f.toast.error("Failed to update song details")}},R=async t=>{if(window.confirm("Are you sure you want to delete this song?"))try{if(_===t&&A.current&&(A.current.pause(),P(null)),j(t),await (0,b.Sk)(t),e){let t=await (0,b.Bi)(e.id);U(t)}f.toast.success("Song deleted successfully")}catch(t){if(console.error("Error deleting song:",t),f.toast.error("Failed to delete song"),e){let t=await (0,b.Bi)(e.id);k(),t.forEach(e=>{i({id:e.id,url:e.url,title:e.title,artist:e.artist??void 0,duration:e.duration,coverUrl:e.cover_url??void 0})}),U(t)}}},D=(0,g.useCallback)(async t=>{if(!e){f.toast.error("Please sign in to upload songs");return}let r={...C};for(let s of(t.forEach(e=>{r[e.name]=!0}),E(r),t))try{let t=s.name.replace(/\.[^/.]+$/,""),[r="",a=t]=t.split(" - "),l=new FormData;l.append("file",s);let o=await fetch("/api/analyze-audio",{method:"POST",body:l}),n=await o.json();if(!n.success){f.toast.error(`Failed to analyze ${s.name}: ${n.error}`),E(e=>({...e,[s.name]:!1}));continue}let c=n.duration;if(c>60){f.toast.error(`${s.name} exceeds the 1-minute limit (${Math.round(c)} seconds)`),E(e=>({...e,[s.name]:!1}));continue}let d=new FileReader;d.onload=async()=>{let t=d.result;try{let l=await (0,b.Hq)({user_id:e.id,title:a.trim(),artist:r.trim(),duration:c,url:t,cover_url:null});if(!l)throw Error("Failed to save song data");let o={id:l.id,url:l.url,title:l.title,artist:l.artist??void 0,duration:l.duration,coverUrl:l.cover_url??void 0,cover_url:l.cover_url??void 0};i(o),f.toast.success(`${s.name} uploaded successfully (${Math.round(c)} seconds)`)}catch(e){console.error("Error saving song:",e),e instanceof Error?f.toast.error(`Failed to upload ${s.name}: ${e.message}`):f.toast.error(`Failed to upload ${s.name}`)}finally{E(e=>({...e,[s.name]:!1}))}},d.onerror=()=>{f.toast.error(`Failed to read file: ${s.name}`),E(e=>({...e,[s.name]:!1}))},d.readAsDataURL(s)}catch(e){console.error("Error processing file:",e),e instanceof Error?f.toast.error(`Failed to process ${s.name}: ${e.message}`):f.toast.error(`Failed to process ${s.name}`),E(e=>({...e,[s.name]:!1}))}},[e,i,C]),{getRootProps:G,getInputProps:I,isDragActive:O}=(0,h.uI)({onDrop:D,accept:{"audio/wav":[".wav"],"audio/mpeg":[".mp3"]},multiple:!0}),T=(0,g.useCallback)(e=>{if(e.length>0){let t=e[0],r=new FileReader;r.onload=()=>{let e=r.result;F(t=>({...t,coverUrl:e}))},r.readAsDataURL(t)}},[]),{getRootProps:H,getInputProps:V}=(0,h.uI)({onDrop:T,accept:{"image/*":[".png",".jpg",".jpeg",".webp"]},multiple:!1});return(0,s.jsxs)("div",{className:"p-6 xl:p-8 w-full",children:[(0,s.jsxs)("div",{className:"pt-6 xl:pt-6 flex flex-col items-center",children:[s.jsx("div",{className:"flex flex-col space-y-6 mb-8 w-full max-w-4xl",children:(0,s.jsxs)("div",{className:"flex items-center justify-start gap-4",children:[(0,s.jsxs)("div",{...G(),className:"relative cursor-pointer",children:[s.jsx("input",{...I()}),(0,s.jsxs)("button",{className:`flex items-center justify-center gap-2 bg-[#5564ff] text-white rounded-xl py-2 px-4 hover:bg-[#5564ff]/90 transition-colors text-sm dark:bg-[#fafafa] dark:hover:bg-[#fafafa]/90 dark:text-[#0a0a0c] ${e?"":"opacity-50 cursor-not-allowed"}`,disabled:!e,children:[s.jsx(l.Z,{className:"w-4 h-4"}),s.jsx("span",{children:"Upload Music"})]}),O&&s.jsx("div",{className:"absolute inset-0 -m-4 rounded-xl bg-black/90 flex items-center justify-center text-white text-sm",children:"Drop your audio files here (1 min max)"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground dark:text-gray-300",children:[s.jsx(o,{className:"w-4 h-4"}),s.jsx("p",{children:"1 minute max"})]}),s.jsx("div",{className:"h-4 w-px bg-gray-300 dark:bg-gray-700"}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground dark:text-gray-300",children:[r.length," / 50 music files used"]})]})}),s.jsx("div",{className:"w-full max-w-4xl",children:M?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsxs)("div",{className:"relative w-10 h-10 mx-auto mb-4",children:[s.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-r from-[#f8d4eb] via-[#ce7acb] to-[#e9bcba] animate-spin"}),s.jsx("div",{className:"absolute inset-1 rounded-full bg-[#0a0a0c]"})]}),s.jsx("p",{className:"text-black/60 dark:text-[#fafafa]",children:"Loading your songs..."})]}):0===r.length&&0===Object.values(C).filter(Boolean).length?s.jsx("div",{className:"flex flex-col items-center justify-center min-h-[60vh] text-center",children:(0,s.jsxs)("div",{className:"max-w-md",children:[s.jsx("div",{className:"mb-6",children:s.jsx(n.Z,{className:"w-16 h-16 mx-auto text-gray-400 dark:text-gray-500"})}),s.jsx("h2",{className:"text-2xl font-semibold mb-4 dark:text-white",children:"No songs yet"}),(0,s.jsxs)("p",{className:"text-muted-foreground dark:text-gray-300",children:["Upload your first song to get started",!e&&s.jsx("span",{className:"block mt-2",children:"Please sign in to upload and save your songs."})]})]})}):(0,s.jsxs)(s.Fragment,{children:[Object.entries(C).filter(([e,t])=>t).map(([e])=>(0,s.jsxs)("div",{className:"bg-white dark:bg-[#0a0a0c] rounded-xl p-4 mb-4 flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"relative w-6 h-6",children:[s.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-r from-[#f8d4eb] via-[#ce7acb] to-[#e9bcba] animate-spin"}),s.jsx("div",{className:"absolute inset-[2px] rounded-full bg-white dark:bg-[#0a0a0c]"})]}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"font-medium dark:text-white",children:e}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Uploading and processing..."})]})]},e)),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-4",children:r.map(e=>{var t;return(0,s.jsxs)("div",{className:"flex flex-col",children:[s.jsx("div",{className:"group relative aspect-square rounded-t-3xl bg-[#1a1a1a] overflow-hidden",children:e.coverUrl||e.cover_url?(0,s.jsxs)(s.Fragment,{children:[s.jsx(p.default,{src:e.coverUrl||e.cover_url||"",alt:`${e.title||e.id} cover`,fill:!0,className:"object-cover"}),(0,s.jsxs)("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity",children:[s.jsx("button",{onClick:t=>{t.stopPropagation(),z(e.id)},className:"absolute top-2 left-2 w-8 h-8 rounded-full bg-[#5564ff] hover:bg-[#5564ff]/90 transition-colors flex items-center justify-center text-white z-20",children:s.jsx(c,{className:"w-4 h-4"})}),s.jsx("button",{onClick:t=>{t.stopPropagation(),R(e.id)},className:"absolute top-2 right-2 w-8 h-8 rounded-full bg-red-500 hover:bg-red-600 transition-colors flex items-center justify-center text-white z-20",children:s.jsx(d.Z,{className:"w-4 h-4"})}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:s.jsx("button",{onClick:t=>{t.stopPropagation(),S(e.id,e.url)},className:"w-12 h-12 rounded-full bg-white/30 hover:bg-white/50 transition-colors flex items-center justify-center text-white pointer-events-auto",children:_===e.id?s.jsx(u.Z,{className:"w-6 h-6"}):s.jsx(x.Z,{className:"w-6 h-6"})})})]})]}):(0,s.jsxs)("div",{className:"h-full w-full flex items-center justify-center",children:[s.jsx(n.Z,{className:"h-12 w-12 text-gray-400"}),(0,s.jsxs)("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity",children:[s.jsx("button",{onClick:t=>{t.stopPropagation(),z(e.id)},className:"absolute top-2 left-2 w-8 h-8 rounded-full bg-[#5564ff] hover:bg-[#5564ff]/90 transition-colors flex items-center justify-center text-white z-20",children:s.jsx(c,{className:"w-4 h-4"})}),s.jsx("button",{onClick:t=>{t.stopPropagation(),R(e.id)},className:"absolute top-2 right-2 w-8 h-8 rounded-full bg-red-500 hover:bg-red-600 transition-colors flex items-center justify-center text-white z-20",children:s.jsx(d.Z,{className:"w-4 h-4"})}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:s.jsx("button",{onClick:t=>{t.stopPropagation(),S(e.id,e.url)},className:"w-12 h-12 rounded-full bg-white/30 hover:bg-white/50 transition-colors flex items-center justify-center text-white pointer-events-auto",children:_===e.id?s.jsx(u.Z,{className:"w-6 h-6"}):s.jsx(x.Z,{className:"w-6 h-6"})})})]})]})}),(0,s.jsxs)("div",{className:"p-2 bg-[#0a0a0c] dark:bg-[#fafafa] rounded-b-3xl",children:[s.jsx("p",{className:"text-sm font-medium text-[#fafafa] dark:text-gray-900 truncate text-center",children:e.title||"Untitled"}),s.jsx("p",{className:"text-xs text-gray-300 dark:text-gray-600 truncate text-center",children:e.artist||"Unknown artist"}),s.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1 text-center",children:(t=e.duration)?`${Math.floor(t/60)}:${Math.floor(t%60).toString().padStart(2,"0")}`:"0:00"})]})]},e.id)})})]})})]}),B&&s.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-[#0a0a0c] rounded-2xl max-w-md w-full p-6 shadow-xl",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-xl font-bold dark:text-white",children:"Edit Song"}),s.jsx("button",{onClick:()=>q(null),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:s.jsx(m,{className:"w-5 h-5"})})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Title"}),s.jsx("input",{type:"text",value:Z.title,onChange:e=>F({...Z,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#5564ff] bg-white dark:bg-[#18181A] text-gray-900 dark:text-white"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Artist"}),s.jsx("input",{type:"text",value:Z.artist,onChange:e=>F({...Z,artist:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#5564ff] bg-white dark:bg-[#18181A] text-gray-900 dark:text-white"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Cover Image"}),(0,s.jsxs)("div",{...H(),className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 text-center cursor-pointer hover:bg-gray-50 dark:hover:bg-[#18181A] transition-colors",children:[s.jsx("input",{...V()}),Z.coverUrl?s.jsx("div",{className:"relative w-32 h-32 mx-auto",children:s.jsx(p.default,{src:Z.coverUrl,alt:"Cover preview",fill:!0,className:"object-cover rounded-lg"})}):(0,s.jsxs)("div",{className:"text-gray-500 dark:text-gray-400",children:[s.jsx(l.Z,{className:"w-12 h-12 mx-auto mb-2 text-gray-400 dark:text-gray-500"}),s.jsx("p",{children:"Drop an image here or click to browse"})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[s.jsx("button",{onClick:()=>q(null),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-[#18181A] transition-colors",children:"Cancel"}),s.jsx("button",{onClick:L,className:"px-4 py-2 bg-[#5564ff] text-white rounded-lg hover:bg-[#5564ff]/90 transition-colors",children:"Save Changes"})]})]})]})})]})}},38271:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(97075).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},3380:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(97075).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},23827:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>l,__esModule:()=>a,default:()=>i});let s=(0,r(86843).createProxy)(String.raw`/Users/twain/Bluum/BLUUM 1.2/Bluum_1.2/app/music/page.tsx`),{__esModule:a,$$typeof:l}=s,i=s.default}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[638,497,843,410,96,465],()=>r(88993));module.exports=s})();